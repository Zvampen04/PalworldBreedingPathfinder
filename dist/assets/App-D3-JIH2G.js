const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Home-DNe1Vkg1.js","./index-D4x1xvc9.js","./index-B6FpfKjJ.css","./ExpandablePaths-DcWAtIhJ.js","./Input-sgc_CmJc.js","./Favorites-C7jrZiDD.js","./Card-CpZkjlEj.js","./Ongoing-CTjXyeu9.js","./CollectionsSection-COBp6UXm.js","./Weaknesses-G19ExV5K.js","./Settings-D-X6ZOAe.js","./index-C_hsjPqb.js","./core-DO-qNFU3.js","./event-DtSbnHQf.js"])))=>i.map(i=>d[i]);
var jt=Object.defineProperty;var Ct=(s,t,a)=>t in s?jt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var Ke=(s,t,a)=>Ct(s,typeof t!="symbol"?t+"":t,a);import{j as e,r,_ as B,R as he}from"./index-D4x1xvc9.js";const Z=()=>e.jsx("div",{className:"loading-card",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-white/20 rounded-full animate-spin spinner-blue-top"}),e.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-transparent rounded-full animate-spin spinner-purple-bottom",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Calculating Breeding Paths"}),e.jsx("p",{className:"text-white/70",children:"Analyzing breeding combinations and finding optimal paths..."}),e.jsxs("div",{className:"flex justify-center space-x-1 mt-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce dot-blue",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce dot-purple",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce dot-green",style:{animationDelay:"300ms"}})]})]})]})}),Ge="palworld-breeding-data",Qe="palworld-breeding-collections",te=()=>{try{const s=localStorage.getItem(Ge);if(s){const t=JSON.parse(s);return t.progress&&Object.keys(t.progress).forEach(a=>{t.progress[a].completedSteps=new Set(t.progress[a].completedSteps||[])}),{favorites:t.favorites||[],progress:t.progress||{}}}}catch(s){console.error("Error reading storage data:",s)}return{favorites:[],progress:{}}},Ne=s=>{try{const t={...s,progress:Object.fromEntries(Object.entries(s.progress).map(([a,o])=>[a,{...o,completedSteps:Array.from(o.completedSteps)}]))};localStorage.setItem(Ge,JSON.stringify(t))}catch(t){console.error("Error saving storage data:",t)}},Xe=()=>te().favorites,St=s=>{const t=te(),a=`fav_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,o={...s,id:a,dateAdded:new Date().toISOString(),customName:s.customName};return t.favorites.push(o),Ne(t),a},kt=s=>{const t=te();t.favorites=t.favorites.filter(a=>a.id!==s),delete t.progress[s],Ne(t)},Nt=(s,t)=>s.type===t.type&&s.pal===t.pal&&s.parents===t.parents&&s.result===t.result&&s.step_number===t.step_number&&s.is_final===t.is_final,_t=(s,t)=>s.startParent===t.startParent&&s.targetChild===t.targetChild&&s.steps.length===t.steps.length&&s.steps.every((a,o)=>Nt(a,t.steps[o])),Pt=(s,t,a)=>{const l=Xe().find(c=>_t(c,{startParent:s,targetChild:t,steps:a}));return l?l.id:null},Zt=s=>te().progress[s]||null,es=(s,t)=>{const a=te();a.progress[s]||(a.progress[s]={pathId:s,completedSteps:new Set,lastUpdated:new Date().toISOString()});const o=a.progress[s];o.completedSteps.has(t)?o.completedSteps.delete(t):o.completedSteps.add(t),o.lastUpdated=new Date().toISOString(),Ne(a)},Tt=()=>{const s=te(),t=[];return s.favorites.forEach(a=>{const o=s.progress[a.id];if(o&&o.completedSteps.size>0){const l=a.steps.filter(b=>b.type!=="start").length;o.completedSteps.size>=l||t.push({favorite:a,progress:o})}}),t.sort((a,o)=>new Date(o.progress.lastUpdated).getTime()-new Date(a.progress.lastUpdated).getTime()),t};function ts(s){return`/Assets/${s.replace(/\s+/g,"_")+".jpg"}`}const se=()=>{try{const s=localStorage.getItem(Qe);if(s)return JSON.parse(s)}catch(s){console.error("Error reading collections:",s)}return[]},ae=s=>{try{localStorage.setItem(Qe,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("collectionsUpdated"))}catch(t){console.error("Error saving collections:",t)}},At=s=>{const t=se(),a=`col_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return t.push({id:a,name:s,favoriteIds:[]}),ae(t),a},Lt=s=>{const t=se().filter(a=>a.id!==s);ae(t)},It=(s,t)=>{const a=se(),o=a.find(l=>l.id===s);o&&!o.favoriteIds.includes(t)&&(o.favoriteIds.push(t),ae(a))},Dt=(s,t)=>{const a=se(),o=a.find(l=>l.id===s);o&&(o.favoriteIds=o.favoriteIds.filter(l=>l!==t),ae(a))},Ft=s=>{const t=se();let a=!1;t.forEach(o=>{const l=o.favoriteIds.length;o.favoriteIds=o.favoriteIds.filter(c=>c!==s),o.favoriteIds.length!==l&&(a=!0)}),a&&ae(t)},Ze=r.createContext(void 0),$t=({children:s})=>{const[t,a]=r.useState([]),[o,l]=r.useState([]),[c,b]=r.useState([]),f=r.useCallback(()=>{a(Xe())},[]),g=r.useCallback(()=>{l(se())},[]),m=r.useCallback(()=>{b(Tt())},[]);r.useEffect(()=>{f(),g(),m()},[f,g,m]),r.useEffect(()=>{const i=()=>f(),L=()=>g(),oe=()=>m();return window.addEventListener("favoritesUpdated",i),window.addEventListener("collectionsUpdated",L),window.addEventListener("storage",i),window.addEventListener("storage",L),window.addEventListener("storage",oe),()=>{window.removeEventListener("favoritesUpdated",i),window.removeEventListener("collectionsUpdated",L),window.removeEventListener("storage",i),window.removeEventListener("storage",L),window.removeEventListener("storage",oe)}},[f,g,m]);const x=r.useCallback(i=>{const L=St(i);return f(),window.dispatchEvent(new CustomEvent("favoritesUpdated")),L},[f]),C=r.useCallback(i=>{kt(i),f(),window.dispatchEvent(new CustomEvent("favoritesUpdated"))},[f]),M=r.useCallback(i=>{const L=At(i);return g(),window.dispatchEvent(new CustomEvent("collectionsUpdated")),L},[g]),H=r.useCallback(i=>{Lt(i),g(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[g]),u=r.useCallback((i,L)=>{It(i,L),g(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[g]),D=r.useCallback((i,L)=>{Dt(i,L),g(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[g]),_=r.useCallback(i=>{Ft(i),g(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[g]),P={favorites:t,collections:o,ongoing:c,refreshFavorites:f,refreshCollections:g,refreshOngoing:m,addFavorite:x,removeFavorite:C,addCollection:M,removeCollection:H,addPathToCollection:u,removePathFromCollection:D,removeFavoriteFromAllCollections:_};return e.jsx(Ze.Provider,{value:P,children:s})};function et(){const s=r.useContext(Ze);if(!s)throw new Error("useFavorites must be used within a FavoritesProvider");return s}const Rt={primary:"bg-blue-600 text-white font-semibold hover:bg-blue-700",secondary:"bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",icon:"p-2 rounded-full bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800",danger:"bg-red-600 text-white font-semibold hover:bg-red-700",default:"bg-white text-gray-800 border border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-700 dark:hover:bg-gray-700"},Mt={sm:"text-xs px-2 py-1",md:"text-sm px-4 py-2",lg:"text-base px-6 py-3"},Ye=({children:s,className:t="",variant:a="default",size:o="md",loading:l=!1,dark:c=!1,disabled:b,...f})=>{const g=b||l,m="transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 rounded disabled:opacity-50 disabled:cursor-not-allowed",x=c?"dark":"",C=[m,Rt[a],Mt[o],t,x].join(" ");return e.jsx("button",{className:C,disabled:g,"aria-busy":l?"true":void 0,"aria-disabled":g?"true":void 0,...f,children:l?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin w-4 h-4 border-2 border-t-transparent border-blue-500 rounded-full"}),e.jsx("span",{children:"Loading..."})]}):s})},_e=r.createContext(void 0),Ot=({children:s})=>{const t=()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[a,o]=r.useState(t());r.useEffect(()=>{const c=f=>{o(f.matches?"dark":"light")},b=window.matchMedia("(prefers-color-scheme: dark)");return b.addEventListener("change",c),()=>b.removeEventListener("change",c)},[]);const l=()=>o(c=>c==="dark"?"light":"dark");return e.jsx(_e.Provider,{value:{mode:a,setMode:o,toggleMode:l},children:s})},Ut=({currentSection:s,onSectionChange:t,onFavoriteSelect:a,onOngoingSelect:o})=>{const[l,c]=r.useState(!1),{favorites:b,ongoing:f}=et(),g=r.useContext(_e),m=(g==null?void 0:g.mode)==="dark",x=r.useMemo(()=>[{id:"home",label:"Home",icon:"🏠",count:null},{id:"favorites",label:"Favorites",icon:"⭐",count:b.length},{id:"ongoing",label:"Ongoing",icon:"🔄",count:f.length},{id:"collections",label:"Collections",icon:"📚",count:null},{id:"weaknesses",label:"Weaknesses",icon:"⚔️",count:null},{id:"settings",label:"Settings",icon:"⚙️",count:null}],[b.length,f.length]),C=u=>{t(u),window.innerWidth<768&&c(!1)},M=r.useCallback(u=>e.jsxs("div",{onClick:()=>a==null?void 0:a(u),className:`p-3 rounded cursor-pointer transition-colors ${m?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx("div",{className:"text-sm font-medium truncate",children:u.name||`${u.startParent} → ${u.targetChild}`}),e.jsxs("div",{className:"text-xs text-gray-500",children:[u.steps.filter(D=>D.type!=="start").length," steps"]})]},u.id),[m,a]),H=r.useCallback(u=>{const D=u.favorite.steps.filter(i=>i.type!=="start").length,_=u.progress.completedSteps.size,P=Math.round(_/D*100);return e.jsxs("div",{onClick:()=>o==null?void 0:o(u),className:`p-3 rounded cursor-pointer transition-colors ${m?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx("div",{className:"text-sm font-medium truncate",children:u.favorite.name||`${u.favorite.startParent} → ${u.favorite.targetChild}`}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[_,"/",D," steps"]}),e.jsxs("div",{className:`text-xs px-2 py-1 rounded ${m?"bg-blue-800 text-blue-200":"bg-blue-100 text-blue-800"}`,children:[P,"%"]})]})]},u.favorite.id)},[m,o]);return e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>c(!1),style:{pointerEvents:"auto"}}),e.jsxs("div",{className:`fixed left-0 top-0 h-full z-50 transition-all duration-300 ${l?window.innerWidth<640?"sidebar-mobile":"w-80":"w-16"} ${m?"bg-gray-900 border-r border-gray-700":"bg-white border-r border-gray-200"}`,children:[e.jsx(Ye,{onClick:()=>c(!l),className:`w-full h-16 flex items-center justify-center transition-colors ${m?"hover:bg-gray-800 text-white":"hover:bg-gray-100 text-gray-800"}`,"aria-label":l?"Collapse sidebar":"Expand sidebar","aria-expanded":l,dark:m,children:e.jsx("span",{className:"text-xl",children:l?"◀":"▶"})}),e.jsx("nav",{"aria-label":"Main navigation",className:"p-2",children:x.map((u,D)=>e.jsx(Ye,{onClick:()=>C(u.id),className:`w-full mb-2 p-4 rounded-lg transition-all duration-200 text-lg ${s===u.id?m?"bg-blue-600 text-accessible-dark":"bg-blue-500 text-accessible-light":m?"hover:bg-gray-800 text-accessible-dark":"hover:bg-gray-100 text-accessible-light"}`,"aria-label":u.label,"aria-current":s===u.id?"page":void 0,tabIndex:0,role:"button",dark:m,onKeyDown:_=>{if(_.key==="ArrowDown"){_.preventDefault();const P=(D+1)%x.length,i=document.querySelectorAll("[data-sidebar-nav]")[P];i&&i.focus()}else if(_.key==="ArrowUp"){_.preventDefault();const P=(D-1+x.length)%x.length,i=document.querySelectorAll("[data-sidebar-nav]")[P];i&&i.focus()}else if(_.key==="Home"){_.preventDefault();const P=document.querySelectorAll("[data-sidebar-nav]")[0];P&&P.focus()}else if(_.key==="End"){_.preventDefault();const P=document.querySelectorAll("[data-sidebar-nav]")[x.length-1];P&&P.focus()}},"data-sidebar-nav":!0,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"text-lg",children:u.icon}),l&&e.jsxs("div",{className:"ml-3 flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:u.label}),u.count!==null&&u.count>0&&e.jsxs("div",{className:`text-xs ${s===u.id?"text-white/80":"text-gray-500"}`,children:[u.count," item",u.count!==1?"s":""]})]})]})},u.id))}),l&&e.jsxs("div",{className:"flex-1 overflow-auto p-2",children:[s==="favorites"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:`text-sm font-semibold px-3 py-2 ${m?"text-gray-400":"text-gray-600"}`,children:["Saved Paths (",b.length,")"]}),b.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-2xl mb-2",children:"⭐"}),e.jsx("div",{className:"text-sm",children:"No favorites yet"}),e.jsx("div",{className:"text-xs mt-1",children:"Star paths to save them here"})]}):b.map(M)]}),s==="ongoing"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:`text-sm font-semibold px-3 py-2 ${m?"text-gray-400":"text-gray-600"}`,children:["Ongoing (",f.length,")"]}),f.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🔄"}),e.jsx("div",{className:"text-sm",children:"No ongoing paths"}),e.jsx("div",{className:"text-xs mt-1",children:"Start a path to track progress"})]}):f.map(H)]})]})]})]})};class ke{static async loadBreedingData(){if(this.breedingData)return this.breedingData;try{const{invoke:t}=await B(async()=>{const{invoke:c}=await import("./core-DO-qNFU3.js");return{invoke:c}},[],import.meta.url),o=(await t("read_breeding_csv")).split(`
`),l=[];for(let c=1;c<o.length;c++){const b=o[c].trim();if(b){const[f,g,m]=b.split(",");f&&g&&m&&l.push({child:f.trim(),parent1:g.trim(),parent2:m.trim()})}}return this.breedingData=l,l}catch(t){return console.error("Failed to load breeding data:",t),[]}}static async findChild(t,a){const l=(await this.loadBreedingData()).find(c=>c.parent1===t&&c.parent2===a||c.parent1===a&&c.parent2===t);return l?l.child:null}static async findParents(t){return(await this.loadBreedingData()).filter(o=>o.child===t).map(o=>({parent1:o.parent1,parent2:o.parent2}))}static async getAllChildren(){const t=await this.loadBreedingData(),a=new Set(t.map(o=>o.child));return Array.from(a).sort()}static async getAllParents(){const t=await this.loadBreedingData(),a=new Set([...t.map(o=>o.parent1),...t.map(o=>o.parent2)]);return Array.from(a).sort()}}Ke(ke,"breedingData",null);const Bt=({open:s,onClose:t,children:a,className:o="",overlayClassName:l=""})=>{const c=r.useRef(null),b=r.useContext(_e),f=(b==null?void 0:b.mode)==="dark";if(r.useEffect(()=>{if(!s)return;const x=C=>{if(C.key==="Escape"&&t(),C.key==="Tab"&&c.current){const M=c.current.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');if(M.length===0)return;const H=M[0],u=M[M.length-1];!C.shiftKey&&document.activeElement===u?(C.preventDefault(),H.focus()):C.shiftKey&&document.activeElement===H&&(C.preventDefault(),u.focus())}};return document.addEventListener("keydown",x),setTimeout(()=>{if(c.current){const C=c.current.querySelector('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');C?C.focus():c.current.focus()}},0),()=>document.removeEventListener("keydown",x)},[s,t]),!s)return null;let g,m="Dialog";return he.Children.forEach(a,x=>{he.isValidElement(x)&&(x.type==="h1"||x.type==="h2"||x.type==="h3")&&(x.props.id?g=x.props.id:x.props.children&&(g="modal-heading-auto",m=void 0))}),e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/40 ${l}`,onClick:t,style:{pointerEvents:"auto"},"aria-modal":"true",role:"dialog",...g?{"aria-labelledby":g}:{"aria-label":m},children:e.jsxs("div",{ref:c,className:`relative rounded-xl shadow-2xl border p-6 transition-all duration-300 ${f?"bg-gray-800 border-gray-700":"bg-white border-blue-200"} ${o}`,onClick:x=>x.stopPropagation(),tabIndex:-1,children:[g==="modal-heading-auto"?e.jsx("h2",{id:"modal-heading-auto",children:m}):null,a]})})},Ce=he.memo(Bt);class zt extends r.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){console.error("❌ React Error Boundary caught an error:",t),console.error("Error info:",a),this.setState({error:t,errorInfo:a})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 p-4",children:e.jsx("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"😵"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"The application encountered an error and couldn't load properly."}),this.state.error&&e.jsxs("details",{className:"text-left bg-gray-50 dark:bg-gray-700 p-4 rounded mb-4",children:[e.jsx("summary",{className:"cursor-pointer font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Error Details"}),e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400 font-mono",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Error:"})," ",this.state.error.message]}),this.state.error.stack&&e.jsxs("div",{children:[e.jsx("strong",{children:"Stack:"}),e.jsx("pre",{className:"whitespace-pre-wrap text-xs mt-1",children:this.state.error.stack})]})]})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition-colors",children:"Reload Application"})]})})}):this.props.children}}window.appTsxLoaded=!0;console.log("🚀 App.tsx module started loading...");console.log("✅ React hooks imported successfully");let Se=null,me=null,ee=null;const Vt=r.lazy(()=>B(()=>import("./Home-DNe1Vkg1.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Wt=r.lazy(()=>B(()=>import("./Favorites-C7jrZiDD.js"),__vite__mapDeps([5,1,2,3,6,4]),import.meta.url)),Ht=r.lazy(()=>B(()=>import("./Ongoing-CTjXyeu9.js"),__vite__mapDeps([7,1,2,3,6]),import.meta.url)),qt=r.lazy(()=>B(()=>import("./CollectionsSection-COBp6UXm.js"),__vite__mapDeps([8,1,2,3,6,4]),import.meta.url)),Jt=r.lazy(()=>B(()=>import("./Weaknesses-G19ExV5K.js"),__vite__mapDeps([9,1,2]),import.meta.url)),Kt=r.lazy(()=>B(()=>import("./Settings-D-X6ZOAe.js"),__vite__mapDeps([10,1,2]),import.meta.url));function Yt(){const{favorites:s,collections:t,ongoing:a,removeFavorite:o,addFavorite:l,addPathToCollection:c}=et(),[b,f]=r.useState(""),[g,m]=r.useState(""),[x,C]=r.useState(""),[M,H]=r.useState(""),[u,D]=r.useState(""),[_,P]=r.useState(""),[i,L]=r.useState("lookup"),[oe,ne]=r.useState(!1),[tt,I]=r.useState(null),[q,fe]=r.useState("home"),[Pe,st]=r.useState(3),[le,rt]=r.useState(""),[ie,Te]=r.useState(20),[Ae,at]=r.useState(!0),[Le,O]=r.useState(null),[ot,J]=r.useState(!1),[Ie,K]=r.useState(null),[Y,De]=r.useState(null),[nt,Fe]=r.useState(null),[lt,xe]=r.useState(null),[it,be]=r.useState(""),[dt,de]=r.useState(null),[ce,ve]=r.useState(null),[$e,ue]=r.useState(!1),[z,Re]=r.useState(null),[Me,pe]=r.useState(!1),[Oe,ge]=r.useState(null),[ct,Ue]=r.useState([]),[ut,Be]=r.useState(null),[ze,Ve]=r.useState(!1);r.useEffect(()=>{(async()=>{try{console.log("🔄 Loading Tauri APIs dynamically...");try{Se=(await B(()=>import("./index-C_hsjPqb.js"),__vite__mapDeps([11,12]),import.meta.url)).Command,console.log("✅ Tauri shell plugin loaded")}catch(d){console.warn("⚠️ Tauri shell plugin not available:",d),Se={sidecar:()=>({execute:async()=>({code:-1,stdout:"",stderr:"Tauri not available"})})}}try{me=(await B(()=>import("./core-DO-qNFU3.js"),[],import.meta.url)).invoke,console.log("✅ Tauri core API loaded")}catch(d){console.warn("⚠️ Tauri core API not available:",d),me=async()=>{throw new Error("Tauri invoke not available")}}try{ee=(await B(()=>import("./event-DtSbnHQf.js"),__vite__mapDeps([13,12]),import.meta.url)).listen,console.log("✅ Tauri event API loaded")}catch(d){console.warn("⚠️ Tauri event API not available:",d),ee=async()=>()=>{}}Ve(!0),console.log("🎉 Tauri APIs ready")}catch(d){console.error("❌ Failed to load Tauri APIs:",d),Ve(!0)}})()},[]);function ye(n,d){ve({message:n,type:d}),setTimeout(()=>ve(null),2500)}r.useEffect(()=>{document.documentElement.classList.remove("dark")},[]),r.useEffect(()=>{if(!ze)return;(async()=>{try{console.log("Loading Pal list from Tauri command...");const d=await me("get_pal_list");Ue(d),console.log(`✓ Received ${d.length} Pal names from Tauri command`)}catch(d){console.error("❌ Failed to load Pal list from Tauri command:",d),Ue([])}})()},[ze]),r.useEffect(()=>{const n=async()=>{O({current:0,max:0,label:"all"}),J(!0),K(null);try{await X("binaries/image-scraper","images"),await X("binaries/breeding-scraper","breeding data"),await X("binaries/fullcalc-scraper","full calc"),O(null),alert("All data updated successfully!")}catch(y){K("Failed to update all data: "+y)}J(!1)},d=async()=>{O({current:0,max:0,label:"images"}),J(!0),K(null);try{await X("binaries/image-scraper","images"),O(null),alert("Images updated successfully!")}catch(y){K("Failed to update images: "+y)}J(!1)},h=async()=>{O({current:0,max:0,label:"breeding data"}),J(!0),K(null);try{await X("binaries/breeding-scraper","breeding data"),O(null),alert("Breeding data updated successfully!")}catch(y){K("Failed to update breeding data: "+y)}J(!1)},T=async()=>{O({current:0,max:0,label:"full calc"}),J(!0),K(null);try{await X("binaries/fullcalc-scraper","full calc"),O(null),alert("Full calculator updated successfully!")}catch(y){K("Failed to update full calculator: "+y)}J(!1)},v=()=>{window.confirm("Are you sure you want to reset all favorites and ongoing progress? This cannot be undone.")&&(localStorage.removeItem("favorites"),localStorage.removeItem("ongoing"),window.dispatchEvent(new CustomEvent("favoritesUpdated")),alert("Local storage reset!"))};return window.addEventListener("updateAllData",n),window.addEventListener("updateImages",d),window.addEventListener("updateBreeding",h),window.addEventListener("updateFullCalc",T),window.addEventListener("resetLocalStorage",v),()=>{window.removeEventListener("updateAllData",n),window.removeEventListener("updateImages",d),window.removeEventListener("updateBreeding",h),window.removeEventListener("updateFullCalc",T),window.removeEventListener("resetLocalStorage",v)}},[]),r.useEffect(()=>{if(Y){Fe(Y);const n=setTimeout(()=>Fe(null),5e3);return()=>clearTimeout(n)}},[Y]);async function X(n,d){return new Promise(async(h,T)=>{let v=0,y=0;O({current:v,max:y,label:d});const $=await ee("sidecar-progress",w=>{const{script:S,current:E,max:U}=w.payload;S===n&&(v=E,y=U,O({current:v,max:y,label:d}),console.log(`📈 Progress update: ${v}/${y} for ${d}`))}),p=await ee("sidecar-output",w=>{const{script:S,output:E}=w.payload;S===n&&console.log(`📊 [${n}] ${E}`)}),j=await ee("sidecar-error",w=>{const{script:S,error:E}=w.payload;S===n&&console.error(`❌ [${n}] ${E}`)}),N=await ee("sidecar-complete",w=>{const{script:S,success:E,exit_code:U}=w.payload;S===n&&($(),p(),j(),N(),E?(console.log(`✅ Script ${n} completed successfully`),h()):(console.error(`❌ Script ${n} failed with exit code ${U}`),T(new Error(`Script failed with exit code ${U}`))))});try{await me("run_sidecar_with_progress",{script:n,label:d})}catch(w){$(),p(),j(),N(),console.error(`💥 Error running script ${n}:`,w),T(w)}})}const We=async n=>{var y,$;let d=i==="lookup"?b:x,h=i==="lookup"?g:M,T=i==="pathfind"?u:"",v=i==="childlookup"?_:"";if(i==="childlookup"&&!v){I({type:"child_lookup",result:"",error:"Please provide a target child"});return}if(i!=="childlookup"&&!d&&!h&&!T){I({type:"parent_lookup",result:"",error:"Please provide at least two parameters"});return}ne(!0),I(null);try{if(i==="lookup"&&d&&h){const p=await ke.findChild(d,h);I(p?{type:"parent_lookup",result:`${d} + ${h} = ${p}`,jsonData:{child:p,parent1:d,parent2:h}}:{type:"parent_lookup",result:"No breeding combination found",jsonData:{child:null,parent1:d,parent2:h}}),ne(!1);return}else if(i==="childlookup"&&v){const p=await ke.findParents(v);if(p.length>0){const j=p.map((N,w)=>({id:w,startParent:N.parent1,targetChild:v,steps:[{type:"start",pal:N.parent1,step_number:0},{type:"breed",parents:`${N.parent1} + ${N.parent2}`,result:v,step_number:1,is_final:!0}],totalSteps:1,totalBreedingSteps:1}));I({type:"child_lookup",result:`Found ${p.length} parent combination(s) for ${v}`,jsonData:{success:!0,start_parent:((y=p[0])==null?void 0:y.parent1)||"",target_child:v,total_paths:j.length,min_steps:1,paths:j.map((N,w)=>({type:"single",path:{id:w,steps:N.steps,total_steps:1}}))}})}else I({type:"child_lookup",result:"No parent combinations found",jsonData:{success:!1,start_parent:"",target_child:v,total_paths:0,min_steps:0,paths:[],message:"No parent combinations found for this child"}});ne(!1);return}if(i==="pathfind"){let p=Pe;le&&!isNaN(Number(le))&&(p=Number(le));let j;if(Ae?typeof n=="number"?j=n:typeof ie=="number"?j=ie:j=20:j=1e6,isNaN(j)&&(j=20),d&&T){let N=[];N=["-p1",d,"-c",T,"--json","--max-paths",String(j)],p>0&&N.push("--max-seconds",String(p)),console.log(`🚀 Executing Python sidecar in ${i} mode`),console.log(`📝 Sidecar: binaries/breeding-path ${N.join(" ")}`),console.log("📋 Arguments:",N),console.log("🔍 DEBUGGING BINARY DISCOVERY:"),console.log("   Target binary: binaries/breeding-path (Tauri will auto-resolve to .exe on Windows)"),console.log(`   Platform: ${navigator.platform}`),console.log(`   User agent: ${navigator.userAgent}`),console.log("📁 Tauri sidecar will automatically resolve the binary name based on platform"),console.log("⚙️ Creating sidecar command...");const w=Se.sidecar("binaries/breeding-path",N);console.log("✅ Command object created successfully"),console.log("🎯 Executing command...");const S=await w.execute();if(console.log("🎉 Sidecar executed successfully"),console.log("📋 Exit code:",S.code),console.log("📋 STDOUT:",S.stdout),console.log("📋 STDERR:",S.stderr),S.code===0)try{const E=JSON.parse(S.stdout);if(E.paths&&Array.isArray(E.paths)){const U=new Map,je=k=>{var V;if(k.type==="single"&&k.path){const F=k.path.steps.filter(Q=>Q.type==="breed").map(Q=>Q.parents).sort().join("|"),R=`${((V=k.path.steps.find(Q=>Q.type==="start"))==null?void 0:V.pal)||""}|${F}`;U.has(R)||U.set(R,k)}},re=k=>{k.type==="single"?je(k):k.type==="group"&&k.children&&k.children.forEach(re)};E.paths.forEach(re);const G=Array.from(U.values());if(G.length>1){const k=new Map;G.forEach(F=>{const W=F.path.steps.filter(R=>R.type==="breed").map(R=>R.parents).sort().join("|");k.has(W)||k.set(W,[]),k.get(W).push(F)});const V=[];k.forEach(F=>{if(F.length===1)V.push(F[0]);else{const W=F[0].path.steps.filter(R=>R.type==="breed");V.push({type:"group",common_steps:W,children:F,count:F.length})}}),E.paths=V,E.total_paths=G.length}else G.length===1?(E.paths=G,E.total_paths=1):(E.paths=[],E.total_paths=0)}I({type:"path_finding",result:S.stdout,jsonData:E})}catch{I({type:"path_finding",result:S.stdout})}else I({type:"path_finding",result:"",error:`Sidecar failed with exit code ${S.code}: ${S.stderr||"No error message"}`})}else throw new Error("For pathfinding, provide a parent and a target child")}else throw new Error("Invalid parameter combination")}catch(p){console.error("💥 Exception during sidecar execution:",p),console.error("💥 Error type:",typeof p),console.error("💥 Error constructor:",($=p==null?void 0:p.constructor)==null?void 0:$.name),p instanceof Error&&(console.error("💥 Error message:",p.message),console.error("💥 Error stack:",p.stack)),console.error("🔬 DETAILED ERROR ANALYSIS:"),console.error("   Error string representation:",String(p)),console.error("   Error JSON:",JSON.stringify(p,null,2)),String(p).includes("not found")&&(console.error("🎯 BINARY NOT FOUND ERROR DETECTED"),console.error("   This suggests Tauri cannot locate the sidecar binary"),console.error("   Check the following:"),console.error("   1. Binary exists in src-tauri/binaries/"),console.error("   2. tauri.conf.json externalBin configuration"),console.error("   3. capabilities/default.json permissions"),console.error("   4. Binary naming convention matches platform")),I({type:i==="lookup"?"parent_lookup":i==="childlookup"?"child_lookup":"path_finding",result:"",error:`Sidecar execution failed: ${p instanceof Error?p.message:"Unknown error occurred"}`})}finally{ne(!1),console.log("🏁 Sidecar execution finished, loading state cleared")}},pt=()=>{f(""),m(""),C(""),H(""),D(""),P(""),I(null)},gt=n=>{L(n),I(null)},He=n=>{C(n.startParent),D(n.targetChild),L("pathfind"),fe("home"),I(null)},qe=n=>{fe("favorites"),De(null),setTimeout(()=>De(n.favorite.id),0),Be(n.favorite.id),setTimeout(()=>Be(null),2e3)},mt=n=>{},ht=()=>{const n=ie+20;Te(n),We(n)},we=he.useRef({});r.useEffect(()=>{var n;Y&&we.current[Y]&&((n=we.current[Y])==null||n.scrollIntoView({behavior:"smooth",block:"center"}))},[Y]);function ft(n,d){var re,G,k,V,F,W,R,Q,Je;const h=s.find(A=>A.id===d);if(!h)return;let T=[],v="",y="";if(n.targetChild===h.startParent)T=[...n.steps,...h.steps.filter(A=>A.type!=="start")],v=n.startParent,y=h.targetChild;else if(h.targetChild===n.startParent)T=[...h.steps,...n.steps.filter(A=>A.type!=="start")],v=h.startParent,y=n.targetChild;else{ye("Paths do not connect!","error"),de(null);return}let $=1;const p=T.map(A=>A.type==="breed"?{...A,step_number:$++,is_final:!1}:{...A});for(let A=p.length-1;A>=0;--A)if(p[A].type==="breed"){p[A].is_final=!0;break}const j=p.filter(A=>A.type==="breed");let N=((G=(re=j[0])==null?void 0:re.parents)==null?void 0:G.split(" + ")[0])||"",w=((V=(k=j[0])==null?void 0:k.parents)==null?void 0:V.split(" + ")[1])||"";!w&&j[1]&&(w=((W=(F=j[1])==null?void 0:F.parents)==null?void 0:W.split(" + ")[0])||"");const S=((R=j[j.length-1])==null?void 0:R.result)||y,E=`${N}${w?" + "+w:""} → ${S}`,U=(Q=h.customName)!=null&&Q.trim()?h.customName:E,je=(Je=h.customName)!=null&&Je.trim()?h.customName:void 0;l({name:U,startParent:v,targetChild:y,steps:p,customName:je}),o(n.id),o(h.id),de(null),ye("Paths combined!","success")}const Ee=n=>{Re(n),ue(!0)},xt=()=>{if(!z||!Oe)return;let n=Pt(z.startParent,z.targetChild,z.steps);if(!n){const d=z.steps.find($=>$.type==="start"),h=z.steps.find($=>$.is_final),T=z.startParent||(d==null?void 0:d.pal)||"Unknown Parent",v=z.targetChild||(h==null?void 0:h.result)||"Unknown Child",y={name:`${T} → ${v}`,startParent:T,targetChild:v,steps:z.steps};n=l(y)}c(Oe,n),ue(!1),pe(!1),Re(null),ge(null),ye("Path added to collection!","success")};function bt(n){xe(n.id),be(n.customName??"")}function vt(){xe(null),be("")}function yt(){xe(null),be("")}function wt(n){de(n.id)}function Et(){de(null)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 -z-10 w-screen h-screen bg-repeat-y bg-gradient-repeat",style:{pointerEvents:"none"}}),e.jsxs("div",{className:"min-h-screen transition-colors duration-300",children:[e.jsx(Ut,{currentSection:q,onSectionChange:fe,onFavoriteSelect:He,onOngoingSelect:qe}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8 relative",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 gradient-header-text",children:"Palworld Breeding Calculator"}),e.jsx("p",{className:`text-lg ${document.documentElement.classList.contains("dark")?"text-white/80":"text-gray-600"}`,children:"Find breeding combinations and shortest paths to your desired Pals"})]}),q==="settings"&&e.jsx(r.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(Kt,{isRunning:ot,progress:Le,progressError:Ie,onUpdateAllData:()=>window.dispatchEvent(new CustomEvent("updateAllData")),onUpdateImages:()=>window.dispatchEvent(new CustomEvent("updateImages")),onUpdateBreeding:()=>window.dispatchEvent(new CustomEvent("updateBreeding")),onResetLocalStorage:()=>window.dispatchEvent(new CustomEvent("resetLocalStorage"))})}),q==="home"&&e.jsx(r.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(Vt,{mode:i,setMode:gt,lookupParent1:b,setLookupParent1:f,lookupParent2:g,setLookupParent2:m,pathfindParent1:x,setPathfindParent1:C,pathfindTargetChild:u,setPathfindTargetChild:D,childLookupTarget:_,setChildLookupTarget:P,computationTime:Pe,setComputationTime:st,customTime:le,setCustomTime:rt,isLoading:oe,result:tt,maxPaths:ie,setMaxPaths:Te,maxPathsEnabled:Ae,setMaxPathsEnabled:at,onRun:We,onClear:pt,onLoadMore:ht,onAddToCollection:Ee,progress:Le,progressError:Ie,palList:ct})}),q==="favorites"&&e.jsx(r.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(Wt,{favorites:s,selectedFavoriteId:Y,highlightedFavoriteId:nt,editingFavoriteId:lt,editingName:it,combiningFavoriteId:dt,handleEditFavoriteName:bt,handleSaveFavoriteName:vt,handleCancelEditFavoriteName:yt,handleCombineWithFavorite:ft,handleStartCombining:wt,handleCancelCombining:Et,handleFavoriteSelect:He,onAddToCollection:Ee,favoriteRefs:we,onRemoveFavorite:mt})}),q==="ongoing"&&e.jsx(r.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(Ht,{ongoing:a,handleOngoingSelect:qe,onAddToCollection:Ee,pulseItemId:ut})}),q==="collections"&&e.jsx(r.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(qt,{})}),q==="weaknesses"&&e.jsx(r.Suspense,{fallback:e.jsx(Z,{}),children:e.jsx(Jt,{})}),q==="home"&&e.jsx(e.Fragment,{})]})})]}),ce&&e.jsx(Ce,{open:!!ce,onClose:()=>ve(null),className:`top-8 left-1/2 -translate-x-1/2 px-6 py-3 rounded-xl-std shadow-xl-std font-semibold text-center transition-all ${ce.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,overlayClassName:"bg-transparent flex items-start justify-center z-50",children:ce.message}),$e&&e.jsxs(Ce,{open:$e,onClose:()=>ue(!1),className:"w-full max-w-sm border-blue-200 rounded-xl-std shadow-xl-std bg-white dark:bg-gray-800 flex flex-col",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 text-blue-700 dark:text-blue-200",children:"Add Path to Collection"}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-4",children:t.length===0?e.jsx("div",{className:"text-gray-400 text-sm text-center",children:"No collections available. Create one first."}):e.jsx("ul",{className:"space-y-2",children:t.map(n=>e.jsx("li",{children:e.jsx("button",{className:`w-full text-left px-4 py-2 rounded transition font-medium border border-gray-300 dark:border-gray-700 group bg-gray-50 dark:bg-gray-800
                        hover:bg-gradient-to-r hover:from-blue-100 hover:to-purple-100 dark:hover:from-blue-900 dark:hover:to-purple-900
                        hover:shadow-lg hover:border-blue-400 dark:hover:border-purple-500`,onClick:()=>{ge(n.id),pe(!0)},children:e.jsx("span",{className:"text-base font-semibold text-blue-900 dark:text-blue-100 group-hover:text-blue-700 dark:group-hover:text-purple-300 transition-colors duration-200",children:n.name})})},n.id))})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>ue(!1),children:"Cancel"})}),Me&&e.jsxs(Ce,{open:Me,onClose:()=>{pe(!1),ge(null)},className:"w-full max-w-sm border-blue-200 rounded-xl-std shadow-xl-std bg-white dark:bg-gray-800",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 text-blue-700 dark:text-blue-200",children:"Confirm Add"}),e.jsx("div",{className:"mb-4 text-gray-700 dark:text-gray-200",children:"Are you sure you want to add this path to the selected collection?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>{pe(!1),ge(null)},children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 transition",onClick:xt,children:"Confirm"})]})]})]})]})}function Gt(){return r.useEffect(()=>{console.log("🚀 App starting..."),console.log("Environment:","production"),console.log("Base URL:","./"),console.log("User Agent:",navigator.userAgent);const s=document.getElementById("debug-status");s&&(s.innerHTML+="<br>🚀 React App starting...",s.innerHTML+="<br>Environment: production",s.innerHTML+="<br>Base URL: ./"),window.__TAURI__?(console.log("✅ Tauri environment detected"),s&&(s.innerHTML+="<br>✅ Tauri environment detected")):(console.log("⚠️  Not in Tauri environment"),s&&(s.innerHTML+="<br>⚠️  Not in Tauri environment")),window.addEventListener("error",t=>{var a;console.error("❌ Global error:",t.error),s&&(s.innerHTML+="<br>❌ Global error: "+(((a=t.error)==null?void 0:a.message)||"Unknown error"))}),window.addEventListener("unhandledrejection",t=>{console.error("❌ Unhandled promise rejection:",t.reason),s&&(s.innerHTML+="<br>❌ Unhandled promise rejection: "+t.reason)})},[]),e.jsx(zt,{children:e.jsx(Ot,{children:e.jsx($t,{children:e.jsx(Yt,{})})})})}const ss=Object.freeze(Object.defineProperty({__proto__:null,default:Gt},Symbol.toStringTag,{value:"Module"}));export{ss as A,Ye as B,Z as L,Ce as M,_e as T,St as a,Zt as b,ts as g,Pt as i,es as t,et as u};
