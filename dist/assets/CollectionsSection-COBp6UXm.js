import{R as h,r as w,j as e}from"./index-D4x1xvc9.js";import{E as I}from"./ExpandablePaths-DcWAtIhJ.js";import{u as D,T as H,B as m,M as C,i as U,a as q}from"./App-D3-JIH2G.js";import{C as G}from"./Card-CpZkjlEj.js";import{I as J}from"./Input-sgc_CmJc.js";const W=()=>{const{collections:x,favorites:f,addCollection:k,removeCollection:$,addPathToCollection:P,removePathFromCollection:T}=D(),[R,b]=h.useState(!1),[u,j]=h.useState(""),[_,g]=h.useState(!1),[r,N]=h.useState(null),[d,n]=h.useState(null),v=w.useContext(H),s=(v==null?void 0:v.mode)==="dark",A=()=>{u.trim()&&(k(u.trim()),j(""),b(!1),n({message:"Collection created!",type:"success"}),setTimeout(()=>n(null),2e3))},S=t=>{N(t),g(!0)},M=t=>{if(!r||!t)return;let o=U(r.startParent||r.start_parent,r.targetChild||r.target_child,r.steps);if(!o){const l=r.steps.find(y=>y.type==="start"),a=r.steps.find(y=>y.is_final),p=r.startParent||r.start_parent||(l==null?void 0:l.pal)||"Unknown Parent",i=r.targetChild||r.target_child||(a==null?void 0:a.result)||"Unknown Child";o=q({name:`${p} â†’ ${i}`,startParent:p,targetChild:i,steps:r.steps})}const c=x.find(l=>l.id===t);c&&c.favoriteIds.includes(o)?n({message:"Path already in collection.",type:"error"}):(P(t,o),n({message:"Path added to collection!",type:"success"})),g(!1),N(null),setTimeout(()=>n(null),2e3)},E=(t,o)=>{T(t,o),n({message:"Path removed from collection.",type:"success"}),setTimeout(()=>n(null),2e3)},B=t=>{$(t),n({message:"Collection removed.",type:"success"}),setTimeout(()=>n(null),2e3)},F=w.useMemo(()=>x.map(t=>{const c=t.favoriteIds.filter(l=>f.some(a=>a.id===l)).map(l=>{const a=f.find(i=>i.id===l);if(!a)return;const p={success:!0,start_parent:a.startParent,target_child:a.targetChild,total_paths:1,min_steps:a.steps.filter(i=>i.type!=="start").length,paths:[{type:"single",path:{id:1,steps:a.steps,total_steps:a.steps.filter(i=>i.type!=="start").length}}]};return{favId:l,favorite:a,data:p}}).filter(l=>!!l);return{col:t,memoizedFavorites:c}}),[x,f]);return e.jsxs("div",{className:"p-8 flex flex-col items-center min-h-[60vh]",children:[e.jsxs("div",{className:"w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:`text-2xl font-bold flex items-center gap-2 ${s?"text-accessible-dark":"text-accessible-light"}`,children:[e.jsx("span",{className:"text-3xl",children:"ðŸ“š"})," Collections"]}),e.jsx(m,{className:"px-4 py-2 rounded font-semibold transition bg-blue-600 text-white hover:bg-blue-700",onClick:()=>b(!0),dark:s,children:"+ New Collection"})]}),x.length===0?e.jsxs("div",{className:`text-center py-16 ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“š"}),e.jsx("div",{className:"mb-1",children:"No collections yet"}),e.jsx("div",{className:"text-xs",children:"Create a collection to get started"})]}):e.jsx("div",{className:"space-y-8",children:F.map(({col:t,memoizedFavorites:o})=>e.jsxs(G,{className:`p-4 shadow-xl-std rounded-xl-std ${s?"bg-gray-900":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`text-lg font-semibold ${s?"text-blue-100":"text-blue-900"}`,children:t.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:[o.length," path",o.length!==1?"s":""]}),e.jsx(m,{className:`ml-4 px-3 py-1 rounded border text-xs font-semibold transition ${s?"border-red-300 text-red-600 hover:bg-red-900 hover:border-red-500":"border-red-300 text-red-600 hover:bg-red-50 hover:border-red-500"}`,title:"Remove entire collection",onClick:()=>B(t.id),"aria-label":`Remove collection ${t.name}`,dark:s,children:"Remove Collection"})]}),o.length===0?e.jsx("div",{className:"text-gray-400 text-sm italic",children:"No paths in this collection yet."}):e.jsx("div",{className:"space-y-6",children:o.map(({favId:c,favorite:l,data:a})=>e.jsx("div",{className:"relative group",children:e.jsx(I,{data:a,maxPaths:1,hideSummaryHeader:!0,summaryHeaderText:`Collection contains ${o.length} path${o.length!==1?"s":""}`,onAddToCollection:S,bottomAction:e.jsx(m,{className:`absolute bottom-2 right-2 p-2 rounded-full text-lg z-20 opacity-80 hover:opacity-100 transition ${s?"hover:bg-red-900 text-red-400":"hover:bg-red-100 text-red-500"}`,title:"Remove this path from collection",onClick:()=>E(t.id,c),"aria-label":`Remove path from ${l.startParent} to ${l.targetChild} from collection ${t.name}`,dark:s,children:"ðŸ—‘ï¸"})})},c))})]},t.id))})]}),e.jsxs(C,{open:R,onClose:()=>b(!1),className:`w-full max-w-sm border-blue-200 rounded-xl-std shadow-xl-std ${s?"bg-gradient-collection-modal-dark border-blue-800":"bg-gradient-collection-modal border-blue-200"}`,children:[e.jsx("h2",{className:`text-lg font-bold mb-4 ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Create New Collection"}),e.jsx(J,{className:"w-full px-3 py-2 rounded border mb-4",placeholder:"Collection name",value:u,onChange:t=>j(t.target.value),autoFocus:!0,theme:s?"dark":"light"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{className:`px-4 py-2 rounded font-semibold transition ${s?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>b(!1),dark:s,children:"Cancel"}),e.jsx(m,{className:"px-4 py-2 rounded font-semibold transition bg-blue-600 text-white hover:bg-blue-700",onClick:A,disabled:!u.trim(),dark:s,children:"Create"})]})]}),e.jsxs(C,{open:_,onClose:()=>g(!1),className:`w-full max-w-md border-2 flex flex-col items-center p-8 rounded-xl-std shadow-xl-std ${s?"bg-gradient-collection-modal-dark border-blue-800":"bg-gradient-collection-modal border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-3xl"}),e.jsx("h2",{className:`text-xl font-bold ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Add Path to Collection"})]}),e.jsx("div",{className:"flex-1 w-full overflow-y-auto mb-6",children:x.length===0?e.jsx("div",{className:"text-gray-400 text-sm text-center",children:"No collections available. Create one first."}):e.jsx("ul",{className:"space-y-2",children:x.map(t=>e.jsx("li",{children:e.jsx(m,{className:`w-full text-left px-4 py-3 rounded-lg font-medium border shadow-sm transition ${s?"bg-blue-950 text-blue-200 border-blue-800 hover:bg-blue-800":"bg-blue-100 text-blue-900 border-blue-200 hover:bg-blue-200"}`,onClick:()=>M(t.id),dark:s,children:t.name})},t.id))})}),e.jsx("div",{className:"flex justify-end gap-2 w-full",children:e.jsx(m,{className:`px-4 py-2 rounded-lg font-semibold transition ${s?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>g(!1),dark:s,children:"Cancel"})})]}),e.jsx(C,{open:!!d,onClose:()=>n(null),className:`top-8 left-1/2 -translate-x-1/2 px-6 py-3 rounded shadow-xl-std font-semibold text-center transition-all ${(d==null?void 0:d.type)==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,overlayClassName:"bg-transparent flex items-start justify-center z-50",children:d==null?void 0:d.message})]})};export{W as default};
