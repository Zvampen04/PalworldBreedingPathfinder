import{r as o,T as z,j as e,g as q,B as E,L as H}from"./index-DWqCGnFO.js";import{E as T}from"./ExpandablePaths-CbT4VF-O.js";import{I as R}from"./Input-CIFe9ZwM.js";const O=({className:r="",theme:n,...f})=>{const h=o.useContext(z),y=(n||(h==null?void 0:h.mode)||"light")==="dark"?"accent-blue-400 focus:ring-blue-400/50":"accent-blue-600 focus:ring-blue-500/50";return e.jsx("input",{type:"radio",className:`${y} focus:ring-2 ${r}`,...f})},S=({label:r,value:n,onChange:f,palList:h,required:w=!1,disabled:y=!1})=>{const j=o.useContext(z),c=(j==null?void 0:j.mode)==="dark",[l,g]=o.useState(!1),[b,v]=o.useState(""),N=o.useRef(null),k=o.useRef(null),[u,x]=o.useState(-1),t=o.useMemo(()=>b?h.filter(a=>a.toLowerCase().includes(b.toLowerCase())):h,[b,h]);o.useEffect(()=>{l&&k.current&&k.current.focus()},[l]),o.useEffect(()=>{const a=d=>{N.current&&!N.current.contains(d.target)&&(g(!1),v(""))};if(l)return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[l]),o.useEffect(()=>{x(l?t.findIndex(a=>a===n):-1)},[l,t,n]);const m=a=>{f(a),g(!1),v("")},D=()=>{y||g(!l)},I=a=>{a.key==="Escape"?(g(!1),v("")):a.key==="Enter"?l&&u>=0&&u<t.length?m(t[u]):!l&&t.length>0&&!n&&g(!0):a.key==="ArrowDown"?(a.preventDefault(),l?x(d=>d<t.length-1?d+1:0):(g(!0),x(0))):a.key==="ArrowUp"&&(a.preventDefault(),l?x(d=>d>0?d-1:t.length-1):(g(!0),x(t.length-1)))};return e.jsxs("div",{className:"relative",ref:N,children:[e.jsxs("label",{id:`palselector-label-${r.replace(/\s+/g,"-")}`,className:`block text-sm font-medium mb-2 ${c?"text-white":"text-gray-800"}`,children:[r,w&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("div",{role:"combobox","aria-haspopup":"listbox","aria-expanded":l,"aria-controls":`palselector-listbox-${r.replace(/\s+/g,"-")}`,"aria-labelledby":`palselector-label-${r.replace(/\s+/g,"-")}`,"aria-activedescendant":l&&u>=0?`palselector-option-${r.replace(/\s+/g,"-")}-${t[u]}`:void 0,tabIndex:0,className:`relative rounded-lg px-3 py-2 cursor-pointer transition-all duration-200 hover:border-blue-500 ${c?"bg-gray-800/80 border border-gray-600 text-white":"bg-white/80 border border-gray-300 text-gray-800"} ${y?"opacity-50 cursor-not-allowed":""} ${l?"border-blue-500 ring-2 ring-blue-500/50":""}`,onClick:D,onKeyDown:I,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[n&&e.jsx("img",{src:q(n),alt:n,className:"w-6 h-6 rounded-full object-cover",onError:a=>{a.target.style.display="none"}}),e.jsx("span",{className:n?c?"text-white":"text-gray-800":c?"text-gray-400":"text-gray-500",children:n||`Select ${r}`})]}),e.jsx("div",{className:`transform transition-transform duration-200 ${l?"rotate-180":""}`,children:"â–¼"})]})}),l&&e.jsxs("div",{id:`palselector-listbox-${r.replace(/\s+/g,"-")}`,role:"listbox","aria-labelledby":`palselector-label-${r.replace(/\s+/g,"-")}`,className:`absolute top-full left-0 right-0 mt-1 rounded-lg shadow-xl backdrop-blur-sm max-h-80 overflow-hidden z-[100] ${c?"bg-gray-800/95 border border-gray-600":"bg-white/95 border border-gray-300"}`,children:[e.jsx("div",{className:`p-2 ${c?"border-b border-gray-600":"border-b border-gray-300"}`,children:e.jsx("input",{ref:k,type:"text","aria-label":`Search ${r}`,placeholder:`Search ${r.toLowerCase()}...`,value:b,onChange:a=>v(a.target.value),onKeyDown:I,className:`w-full border rounded px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 ${c?"bg-gray-700/80 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-800 placeholder-gray-500"}`,autoComplete:"off"})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:t.length>0?t.map((a,d)=>e.jsxs("div",{id:`palselector-option-${r.replace(/\s+/g,"-")}-${a}`,role:"option","aria-selected":a===n,className:`flex items-center space-x-3 px-3 py-2 cursor-pointer transition-colors ${c?"hover:bg-gray-700/50 text-white":"hover:bg-gray-100 text-gray-800"} ${u===d?c?"bg-blue-700/60":"bg-blue-100":""}`,onClick:()=>m(a),onMouseEnter:()=>x(d),children:[e.jsx("img",{src:q(a),alt:a,className:"w-6 h-6 rounded-full object-cover",onError:$=>{$.target.style.display="none"}}),e.jsx("span",{children:a})]},a)):e.jsxs("div",{className:`px-3 py-4 text-center ${c?"text-gray-400":"text-gray-500"}`,children:['No Pals found matching "',b,'"']})}),n&&e.jsx("div",{className:`p-2 ${c?"border-t border-gray-600":"border-t border-gray-300"}`,children:e.jsx("button",{onClick:()=>m(""),"aria-label":"Clear selection",className:`w-full text-left px-3 py-2 text-red-400 rounded transition-colors ${c?"hover:bg-gray-700/50":"hover:bg-gray-100"}`,children:"Clear Selection"})})]})]})},G=({mode:r,setMode:n,lookupParent1:f,setLookupParent1:h,lookupParent2:w,setLookupParent2:y,pathfindParent1:j,setPathfindParent1:c,pathfindParent2:l,setPathfindParent2:g,pathfindTargetChild:b,setPathfindTargetChild:v,computationTime:N,setComputationTime:k,customTime:u,setCustomTime:x,isLoading:t,result:m,maxPaths:D,setMaxPaths:I,maxPathsEnabled:a,setMaxPathsEnabled:d,onRun:$,onClear:A,onLoadMore:B,onAddToCollection:K,progress:p,progressError:F,palList:C})=>{const P=o.useContext(z),s=(P==null?void 0:P.mode)==="dark";return e.jsxs("div",{id:"main-content",className:`p-6 md:p-8 mb-6 rounded-xl-std shadow-xl-std transition-all duration-300 ${s?"bg-white/10 backdrop-blur-md border border-white/20":"bg-white/80 backdrop-blur-md border border-gray-200"}`,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:`block font-semibold mb-3 ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Mode:"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx(O,{type:"radio",name:"mode",value:"lookup",checked:r==="lookup",onChange:i=>n(i.target.value),className:"sr-only",theme:s?"dark":"light"}),e.jsx(E,{type:"button",variant:r==="lookup"?"primary":"secondary",size:"lg",dark:s,className:"px-6 py-3 rounded-lg font-semibold transition-all",onClick:()=>n("lookup"),"aria-pressed":r==="lookup",children:"ðŸ” Parent Lookup"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx(O,{type:"radio",name:"mode",value:"pathfind",checked:r==="pathfind",onChange:i=>n(i.target.value),className:"sr-only",theme:s?"dark":"light"}),e.jsx(E,{type:"button",variant:r==="pathfind"?"primary":"secondary",size:"lg",dark:s,className:"px-6 py-3 rounded-lg font-semibold transition-all",onClick:()=>n("pathfind"),"aria-pressed":r==="pathfind",children:"ðŸŽ¯ Path Finding"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:[r==="lookup"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(S,{label:"Parent 1",value:f,onChange:h,palList:C,required:!0,disabled:t})}),e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(S,{label:"Parent 2",value:w,onChange:y,palList:C,required:!0,disabled:t})})]}),r==="pathfind"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(S,{label:"Parent 1",value:j,onChange:c,palList:C,required:!1,disabled:t})}),e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(S,{label:"Parent 2 (Optional)",value:l,onChange:g,palList:C,required:!1,disabled:t})}),e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(S,{label:"Target Child",value:b,onChange:v,palList:C,required:!0,disabled:t})})]})]}),r==="pathfind"&&e.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Computation Time:"}),[1,3,5,10].map(i=>e.jsxs(E,{onClick:()=>{k(i),x("")},variant:N===i&&!u?"primary":"secondary",size:"sm",dark:s,children:[i,"s"]},i)),e.jsx(R,{type:"number",min:1,max:60,placeholder:"Custom",value:u,onChange:i=>{x(i.target.value),k(Number(i.target.value)||N)},className:"w-20 ml-2",theme:s?"dark":"light"}),e.jsx("span",{className:`text-xs ml-2 ${s?"text-gray-400":"text-gray-500"}`,children:"seconds"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{type:"checkbox",checked:a,onChange:i=>d(i.target.checked),className:"mr-2",theme:s?"dark":"light"}),e.jsx("span",{className:`font-medium ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Limit Max Paths"}),e.jsx(R,{type:"number",min:1,max:1e3,value:D,onChange:i=>I(Number(i.target.value)||20),className:"w-20 ml-2",theme:s?"dark":"light",disabled:!a}),e.jsx("span",{className:`text-xs ml-2 ${s?"text-gray-400":"text-gray-500"}`,children:"paths"})]})]}),p&&e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:`text-lg font-semibold mb-2 ${s?"text-accessible-dark":"text-accessible-light"}`,children:`Updating ${p.label}...`}),p.max>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-2 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:`${p.current/p.max*100}%`}})}),e.jsxs("div",{className:`text-sm ${s?"text-gray-200":"text-gray-700"}`,children:[p.current," / ",p.max]})]}):e.jsx("div",{className:`text-sm ${s?"text-gray-200":"text-gray-700"}`,children:"Starting..."})]}),F&&e.jsx("div",{className:"mt-4 text-red-500 font-semibold",children:F}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center mb-8",children:[e.jsx(E,{onClick:$,disabled:r==="lookup"?!f||!w:t||!j&&!l,variant:"primary",size:"lg",loading:t,dark:s,children:t?"Calculating...":`${r==="lookup"?"Find Child":"Find Paths"}`}),e.jsx(E,{onClick:A,variant:"secondary",size:"lg",dark:s,children:"Clear All"})]}),r==="lookup"&&m&&!t&&e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${s?"text-green-200":"text-green-800"}`,children:"Breeding Result"}),e.jsx("div",{className:`mt-4 text-lg ${s?"text-white":"text-gray-800"}`,children:m.result})]}),r==="pathfind"&&m&&!t&&m.type==="path_finding"&&m.jsonData&&e.jsx(T,{data:m.jsonData,maxPaths:D,onLoadMore:B,onAddToCollection:K}),t&&e.jsx(H,{})]})};export{G as default};
