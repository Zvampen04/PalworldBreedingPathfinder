import{R as x,r as N,j as e}from"./index-C44N1bVH.js";import{E as F}from"./ExpandablePaths-RjC-xIgd.js";import{u as I,T as D,B as c,M as y,i as H,a as U}from"./App-CjdM32UX.js";import{C as q}from"./Card-Z0hDohip.js";import{I as G}from"./Input-VEm_snOz.js";const W=()=>{const{collections:m,favorites:p,addCollection:w,removeCollection:k,addPathToCollection:$,removePathFromCollection:P}=I(),[T,h]=x.useState(!1),[b,C]=x.useState(""),[S,u]=x.useState(!1),[a,j]=x.useState(null),[f,n]=x.useState(null),s=N.useContext(D)?.mode==="dark",R=()=>{b.trim()&&(w(b.trim()),C(""),h(!1),n({message:"Collection created!",type:"success"}),setTimeout(()=>n(null),2e3))},_=t=>{j(t),u(!0)},A=t=>{if(!a||!t)return;let l=H(a.startParent||a.start_parent,a.targetChild||a.target_child,a.steps);if(!l){const o=a.steps.find(v=>v.type==="start"),r=a.steps.find(v=>v.is_final),g=a.startParent||a.start_parent||o?.pal||"Unknown Parent",i=a.targetChild||a.target_child||r?.result||"Unknown Child";l=U({name:`${g} → ${i}`,startParent:g,targetChild:i,steps:a.steps})}const d=m.find(o=>o.id===t);d&&d.favoriteIds.includes(l)?n({message:"Path already in collection.",type:"error"}):($(t,l),n({message:"Path added to collection!",type:"success"})),u(!1),j(null),setTimeout(()=>n(null),2e3)},M=(t,l)=>{P(t,l),n({message:"Path removed from collection.",type:"success"}),setTimeout(()=>n(null),2e3)},E=t=>{k(t),n({message:"Collection removed.",type:"success"}),setTimeout(()=>n(null),2e3)},B=N.useMemo(()=>m.map(t=>{const d=t.favoriteIds.filter(o=>p.some(r=>r.id===o)).map(o=>{const r=p.find(i=>i.id===o);if(!r)return;const g={success:!0,start_parent:r.startParent,target_child:r.targetChild,total_paths:1,min_steps:r.steps.filter(i=>i.type!=="start").length,paths:[{type:"single",path:{id:1,steps:r.steps,total_steps:r.steps.filter(i=>i.type!=="start").length}}]};return{favId:o,favorite:r,data:g}}).filter(o=>!!o);return{col:t,memoizedFavorites:d}}),[m,p]);return e.jsxs("div",{className:"p-8 flex flex-col items-center min-h-[60vh]",children:[e.jsxs("div",{className:"w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:`text-2xl font-bold flex items-center gap-2 ${s?"text-accessible-dark":"text-accessible-light"}`,children:[e.jsx("span",{className:"text-3xl",children:"📚"})," Collections"]}),e.jsx(c,{className:"px-4 py-2 rounded font-semibold transition bg-blue-600 text-white hover:bg-blue-700",onClick:()=>h(!0),dark:s,children:"+ New Collection"})]}),m.length===0?e.jsxs("div",{className:`text-center py-16 ${s?"text-gray-400":"text-gray-500"}`,children:[e.jsx("div",{className:"text-4xl mb-2",children:"📚"}),e.jsx("div",{className:"mb-1",children:"No collections yet"}),e.jsx("div",{className:"text-xs",children:"Create a collection to get started"})]}):e.jsx("div",{className:"space-y-8",children:B.map(({col:t,memoizedFavorites:l})=>e.jsxs(q,{className:`p-4 shadow-xl-std rounded-xl-std ${s?"bg-gray-900":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`text-lg font-semibold ${s?"text-blue-100":"text-blue-900"}`,children:t.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:[l.length," path",l.length!==1?"s":""]}),e.jsx(c,{className:`ml-4 px-3 py-1 rounded border text-xs font-semibold transition ${s?"border-red-300 text-red-600 hover:bg-red-900 hover:border-red-500":"border-red-300 text-red-600 hover:bg-red-50 hover:border-red-500"}`,title:"Remove entire collection",onClick:()=>E(t.id),"aria-label":`Remove collection ${t.name}`,dark:s,children:"Remove Collection"})]}),l.length===0?e.jsx("div",{className:"text-gray-400 text-sm italic",children:"No paths in this collection yet."}):e.jsx("div",{className:"space-y-6",children:l.map(({favId:d,favorite:o,data:r})=>e.jsx("div",{className:"relative group",children:e.jsx(F,{data:r,maxPaths:1,hideSummaryHeader:!0,summaryHeaderText:`Collection contains ${l.length} path${l.length!==1?"s":""}`,onAddToCollection:_,bottomAction:e.jsx(c,{className:`absolute bottom-2 right-2 p-2 rounded-full text-lg z-20 opacity-80 hover:opacity-100 transition ${s?"hover:bg-red-900 text-red-400":"hover:bg-red-100 text-red-500"}`,title:"Remove this path from collection",onClick:()=>M(t.id,d),"aria-label":`Remove path from ${o.startParent} to ${o.targetChild} from collection ${t.name}`,dark:s,children:"🗑️"})})},d))})]},t.id))})]}),e.jsxs(y,{open:T,onClose:()=>h(!1),className:`w-full max-w-sm border-blue-200 rounded-xl-std shadow-xl-std ${s?"bg-gradient-collection-modal-dark border-blue-800":"bg-gradient-collection-modal border-blue-200"}`,children:[e.jsx("h2",{className:`text-lg font-bold mb-4 ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Create New Collection"}),e.jsx(G,{className:"w-full px-3 py-2 rounded border mb-4",placeholder:"Collection name",value:b,onChange:t=>C(t.target.value),autoFocus:!0,theme:s?"dark":"light"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{className:`px-4 py-2 rounded font-semibold transition ${s?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>h(!1),dark:s,children:"Cancel"}),e.jsx(c,{className:"px-4 py-2 rounded font-semibold transition bg-blue-600 text-white hover:bg-blue-700",onClick:R,disabled:!b.trim(),dark:s,children:"Create"})]})]}),e.jsxs(y,{open:S,onClose:()=>u(!1),className:`w-full max-w-md border-2 flex flex-col items-center p-8 rounded-xl-std shadow-xl-std ${s?"bg-gradient-collection-modal-dark border-blue-800":"bg-gradient-collection-modal border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-3xl"}),e.jsx("h2",{className:`text-xl font-bold ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Add Path to Collection"})]}),e.jsx("div",{className:"flex-1 w-full overflow-y-auto mb-6",children:m.length===0?e.jsx("div",{className:"text-gray-400 text-sm text-center",children:"No collections available. Create one first."}):e.jsx("ul",{className:"space-y-2",children:m.map(t=>e.jsx("li",{children:e.jsx(c,{className:`w-full text-left px-4 py-3 rounded-lg font-medium border shadow-sm transition ${s?"bg-blue-950 text-blue-200 border-blue-800 hover:bg-blue-800":"bg-blue-100 text-blue-900 border-blue-200 hover:bg-blue-200"}`,onClick:()=>A(t.id),dark:s,children:t.name})},t.id))})}),e.jsx("div",{className:"flex justify-end gap-2 w-full",children:e.jsx(c,{className:`px-4 py-2 rounded-lg font-semibold transition ${s?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>u(!1),dark:s,children:"Cancel"})})]}),e.jsx(y,{open:!!f,onClose:()=>n(null),className:`top-8 left-1/2 -translate-x-1/2 px-6 py-3 rounded shadow-xl-std font-semibold text-center transition-all ${f?.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,overlayClassName:"bg-transparent flex items-start justify-center z-50",children:f?.message})]})};export{W as default};
