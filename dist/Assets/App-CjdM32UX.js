const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Home-BKUgmSkZ.js","./index-C44N1bVH.js","./index-B18Yt59I.css","./ExpandablePaths-RjC-xIgd.js","./Input-VEm_snOz.js","./Favorites-BxZv8Rpt.js","./Card-Z0hDohip.js","./Ongoing-DBkgtTBk.js","./CollectionsSection-CZk0Mrrt.js","./Weaknesses-P9APNICs.js","./Settings-BuyjKNtP.js"])))=>i.map(i=>d[i]);
import{j as e,r,R as pe,_ as Q}from"./index-C44N1bVH.js";const Y=()=>e.jsx("div",{className:"loading-card",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-white/20 rounded-full animate-spin spinner-blue-top"}),e.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-transparent rounded-full animate-spin spinner-purple-bottom",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-white rounded-full"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Calculating Breeding Paths"}),e.jsx("p",{className:"text-white/70",children:"Analyzing breeding combinations and finding optimal paths..."}),e.jsxs("div",{className:"flex justify-center space-x-1 mt-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce dot-blue",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce dot-purple",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce dot-green",style:{animationDelay:"300ms"}})]})]})]})}),He="palworld-breeding-data",Ve="palworld-breeding-collections",X=()=>{try{const s=localStorage.getItem(He);if(s){const t=JSON.parse(s);return t.progress&&Object.keys(t.progress).forEach(a=>{t.progress[a].completedSteps=new Set(t.progress[a].completedSteps||[])}),{favorites:t.favorites||[],progress:t.progress||{}}}}catch(s){console.error("Error reading storage data:",s)}return{favorites:[],progress:{}}},Ee=s=>{try{const t={...s,progress:Object.fromEntries(Object.entries(s.progress).map(([a,o])=>[a,{...o,completedSteps:Array.from(o.completedSteps)}]))};localStorage.setItem(He,JSON.stringify(t))}catch(t){console.error("Error saving storage data:",t)}},qe=()=>X().favorites,xt=s=>{const t=X(),a=`fav_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,o={...s,id:a,dateAdded:new Date().toISOString(),customName:s.customName};return t.favorites.push(o),Ee(t),a},bt=s=>{const t=X();t.favorites=t.favorites.filter(a=>a.id!==s),delete t.progress[s],Ee(t)},vt=(s,t)=>s.type===t.type&&s.pal===t.pal&&s.parents===t.parents&&s.result===t.result&&s.step_number===t.step_number&&s.is_final===t.is_final,yt=(s,t)=>s.startParent===t.startParent&&s.targetChild===t.targetChild&&s.steps.length===t.steps.length&&s.steps.every((a,o)=>vt(a,t.steps[o])),wt=(s,t,a)=>{const i=qe().find(p=>yt(p,{startParent:s,targetChild:t,steps:a}));return i?i.id:null},Ht=s=>X().progress[s]||null,Vt=(s,t)=>{const a=X();a.progress[s]||(a.progress[s]={pathId:s,completedSteps:new Set,lastUpdated:new Date().toISOString()});const o=a.progress[s];o.completedSteps.has(t)?o.completedSteps.delete(t):o.completedSteps.add(t),o.lastUpdated=new Date().toISOString(),Ee(a)},Et=()=>{const s=X(),t=[];return s.favorites.forEach(a=>{const o=s.progress[a.id];if(o&&o.completedSteps.size>0){const i=a.steps.filter(w=>w.type!=="start").length;o.completedSteps.size>=i||t.push({favorite:a,progress:o})}}),t.sort((a,o)=>new Date(o.progress.lastUpdated).getTime()-new Date(a.progress.lastUpdated).getTime()),t};function qt(s){return`/Assets/${s.replace(/\s+/g,"_")+".jpg"}`}const Z=()=>{try{const s=localStorage.getItem(Ve);if(s)return JSON.parse(s)}catch(s){console.error("Error reading collections:",s)}return[]},te=s=>{try{localStorage.setItem(Ve,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("collectionsUpdated"))}catch(t){console.error("Error saving collections:",t)}},jt=s=>{const t=Z(),a=`col_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return t.push({id:a,name:s,favoriteIds:[]}),te(t),a},St=s=>{const t=Z().filter(a=>a.id!==s);te(t)},Ct=(s,t)=>{const a=Z(),o=a.find(i=>i.id===s);o&&!o.favoriteIds.includes(t)&&(o.favoriteIds.push(t),te(a))},kt=(s,t)=>{const a=Z(),o=a.find(i=>i.id===s);o&&(o.favoriteIds=o.favoriteIds.filter(i=>i!==t),te(a))},Nt=s=>{const t=Z();let a=!1;t.forEach(o=>{const i=o.favoriteIds.length;o.favoriteIds=o.favoriteIds.filter(p=>p!==s),o.favoriteIds.length!==i&&(a=!0)}),a&&te(t)},Je=r.createContext(void 0),_t=({children:s})=>{const[t,a]=r.useState([]),[o,i]=r.useState([]),[p,w]=r.useState([]),x=r.useCallback(()=>{a(qe())},[]),m=r.useCallback(()=>{i(Z())},[]),h=r.useCallback(()=>{w(Et())},[]);r.useEffect(()=>{x(),m(),h()},[x,m,h]),r.useEffect(()=>{const c=()=>x(),_=()=>m(),se=()=>h();return window.addEventListener("favoritesUpdated",c),window.addEventListener("collectionsUpdated",_),window.addEventListener("storage",c),window.addEventListener("storage",_),window.addEventListener("storage",se),()=>{window.removeEventListener("favoritesUpdated",c),window.removeEventListener("collectionsUpdated",_),window.removeEventListener("storage",c),window.removeEventListener("storage",_),window.removeEventListener("storage",se)}},[x,m,h]);const v=r.useCallback(c=>{const _=xt(c);return x(),window.dispatchEvent(new CustomEvent("favoritesUpdated")),_},[x]),j=r.useCallback(c=>{bt(c),x(),window.dispatchEvent(new CustomEvent("favoritesUpdated"))},[x]),$=r.useCallback(c=>{const _=jt(c);return m(),window.dispatchEvent(new CustomEvent("collectionsUpdated")),_},[m]),B=r.useCallback(c=>{St(c),m(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[m]),d=r.useCallback((c,_)=>{Ct(c,_),m(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[m]),L=r.useCallback((c,_)=>{kt(c,_),m(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[m]),C=r.useCallback(c=>{Nt(c),m(),window.dispatchEvent(new CustomEvent("collectionsUpdated"))},[m]),k={favorites:t,collections:o,ongoing:p,refreshFavorites:x,refreshCollections:m,refreshOngoing:h,addFavorite:v,removeFavorite:j,addCollection:$,removeCollection:B,addPathToCollection:d,removePathFromCollection:L,removeFavoriteFromAllCollections:C};return e.jsx(Je.Provider,{value:k,children:s})};function Ke(){const s=r.useContext(Je);if(!s)throw new Error("useFavorites must be used within a FavoritesProvider");return s}const Pt={primary:"bg-blue-600 text-white font-semibold hover:bg-blue-700",secondary:"bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",icon:"p-2 rounded-full bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800",danger:"bg-red-600 text-white font-semibold hover:bg-red-700",default:"bg-white text-gray-800 border border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-700 dark:hover:bg-gray-700"},Tt={sm:"text-xs px-2 py-1",md:"text-sm px-4 py-2",lg:"text-base px-6 py-3"},ze=({children:s,className:t="",variant:a="default",size:o="md",loading:i=!1,dark:p=!1,disabled:w,...x})=>{const m=w||i,h="transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 rounded disabled:opacity-50 disabled:cursor-not-allowed",v=p?"dark":"",j=[h,Pt[a],Tt[o],t,v].join(" ");return e.jsx("button",{className:j,disabled:m,"aria-busy":i?"true":void 0,"aria-disabled":m?"true":void 0,...x,children:i?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin w-4 h-4 border-2 border-t-transparent border-blue-500 rounded-full"}),e.jsx("span",{children:"Loading..."})]}):s})},je=r.createContext(void 0),At=({children:s})=>{const t=()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[a,o]=r.useState(t());r.useEffect(()=>{const p=x=>{o(x.matches?"dark":"light")},w=window.matchMedia("(prefers-color-scheme: dark)");return w.addEventListener("change",p),()=>w.removeEventListener("change",p)},[]);const i=()=>o(p=>p==="dark"?"light":"dark");return e.jsx(je.Provider,{value:{mode:a,setMode:o,toggleMode:i},children:s})},Lt=({currentSection:s,onSectionChange:t,onFavoriteSelect:a,onOngoingSelect:o})=>{const[i,p]=r.useState(!1),{favorites:w,ongoing:x}=Ke(),h=r.useContext(je)?.mode==="dark",v=r.useMemo(()=>[{id:"home",label:"Home",icon:"🏠",count:null},{id:"favorites",label:"Favorites",icon:"⭐",count:w.length},{id:"ongoing",label:"Ongoing",icon:"🔄",count:x.length},{id:"collections",label:"Collections",icon:"📚",count:null},{id:"weaknesses",label:"Weaknesses",icon:"⚔️",count:null},{id:"settings",label:"Settings",icon:"⚙️",count:null}],[w.length,x.length]),j=d=>{t(d),window.innerWidth<768&&p(!1)},$=r.useCallback(d=>e.jsxs("div",{onClick:()=>a?.(d),className:`p-3 rounded cursor-pointer transition-colors ${h?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx("div",{className:"text-sm font-medium truncate",children:d.name||`${d.startParent} → ${d.targetChild}`}),e.jsxs("div",{className:"text-xs text-gray-500",children:[d.steps.filter(L=>L.type!=="start").length," steps"]})]},d.id),[h,a]),B=r.useCallback(d=>{const L=d.favorite.steps.filter(c=>c.type!=="start").length,C=d.progress.completedSteps.size,k=Math.round(C/L*100);return e.jsxs("div",{onClick:()=>o?.(d),className:`p-3 rounded cursor-pointer transition-colors ${h?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx("div",{className:"text-sm font-medium truncate",children:d.favorite.name||`${d.favorite.startParent} → ${d.favorite.targetChild}`}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[C,"/",L," steps"]}),e.jsxs("div",{className:`text-xs px-2 py-1 rounded ${h?"bg-blue-800 text-blue-200":"bg-blue-100 text-blue-800"}`,children:[k,"%"]})]})]},d.favorite.id)},[h,o]);return e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>p(!1),style:{pointerEvents:"auto"}}),e.jsxs("div",{className:`fixed left-0 top-0 h-full z-50 transition-all duration-300 ${i?window.innerWidth<640?"sidebar-mobile":"w-80":"w-16"} ${h?"bg-gray-900 border-r border-gray-700":"bg-white border-r border-gray-200"}`,children:[e.jsx(ze,{onClick:()=>p(!i),className:`w-full h-16 flex items-center justify-center transition-colors ${h?"hover:bg-gray-800 text-white":"hover:bg-gray-100 text-gray-800"}`,"aria-label":i?"Collapse sidebar":"Expand sidebar","aria-expanded":i,dark:h,children:e.jsx("span",{className:"text-xl",children:i?"◀":"▶"})}),e.jsx("nav",{"aria-label":"Main navigation",className:"p-2",children:v.map((d,L)=>e.jsx(ze,{onClick:()=>j(d.id),className:`w-full mb-2 p-4 rounded-lg transition-all duration-200 text-lg ${s===d.id?h?"bg-blue-600 text-accessible-dark":"bg-blue-500 text-accessible-light":h?"hover:bg-gray-800 text-accessible-dark":"hover:bg-gray-100 text-accessible-light"}`,"aria-label":d.label,"aria-current":s===d.id?"page":void 0,tabIndex:0,role:"button",dark:h,onKeyDown:C=>{if(C.key==="ArrowDown"){C.preventDefault();const k=(L+1)%v.length,c=document.querySelectorAll("[data-sidebar-nav]")[k];c&&c.focus()}else if(C.key==="ArrowUp"){C.preventDefault();const k=(L-1+v.length)%v.length,c=document.querySelectorAll("[data-sidebar-nav]")[k];c&&c.focus()}else if(C.key==="Home"){C.preventDefault();const k=document.querySelectorAll("[data-sidebar-nav]")[0];k&&k.focus()}else if(C.key==="End"){C.preventDefault();const k=document.querySelectorAll("[data-sidebar-nav]")[v.length-1];k&&k.focus()}},"data-sidebar-nav":!0,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"text-lg",children:d.icon}),i&&e.jsxs("div",{className:"ml-3 flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:d.label}),d.count!==null&&d.count>0&&e.jsxs("div",{className:`text-xs ${s===d.id?"text-white/80":"text-gray-500"}`,children:[d.count," item",d.count!==1?"s":""]})]})]})},d.id))}),i&&e.jsxs("div",{className:"flex-1 overflow-auto p-2",children:[s==="favorites"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:`text-sm font-semibold px-3 py-2 ${h?"text-gray-400":"text-gray-600"}`,children:["Saved Paths (",w.length,")"]}),w.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-2xl mb-2",children:"⭐"}),e.jsx("div",{className:"text-sm",children:"No favorites yet"}),e.jsx("div",{className:"text-xs mt-1",children:"Star paths to save them here"})]}):w.map($)]}),s==="ongoing"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:`text-sm font-semibold px-3 py-2 ${h?"text-gray-400":"text-gray-600"}`,children:["Ongoing (",x.length,")"]}),x.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🔄"}),e.jsx("div",{className:"text-sm",children:"No ongoing paths"}),e.jsx("div",{className:"text-xs mt-1",children:"Start a path to track progress"})]}):x.map(B)]})]})]})]})};class We{static breedingData=null;static async loadBreedingData(){if(this.breedingData)return this.breedingData;try{if(!window.__TAURI__)throw new Error("Tauri APIs not available");const a=(await window.__TAURI__.invoke("read_breeding_csv")).split(`
`),o=[];for(let i=1;i<a.length;i++){const p=a[i].trim();if(p){const[w,x,m]=p.split(",");w&&x&&m&&o.push({child:w.trim(),parent1:x.trim(),parent2:m.trim()})}}return this.breedingData=o,o}catch(t){return console.error("Failed to load breeding data:",t),[]}}static async findChild(t,a){const i=(await this.loadBreedingData()).find(p=>p.parent1===t&&p.parent2===a||p.parent1===a&&p.parent2===t);return i?i.child:null}static async findParents(t){return(await this.loadBreedingData()).filter(o=>o.child===t).map(o=>({parent1:o.parent1,parent2:o.parent2}))}static async getAllChildren(){const t=await this.loadBreedingData(),a=new Set(t.map(o=>o.child));return Array.from(a).sort()}static async getAllParents(){const t=await this.loadBreedingData(),a=new Set([...t.map(o=>o.parent1),...t.map(o=>o.parent2)]);return Array.from(a).sort()}}const It=({open:s,onClose:t,children:a,className:o="",overlayClassName:i=""})=>{const p=r.useRef(null),x=r.useContext(je)?.mode==="dark";if(r.useEffect(()=>{if(!s)return;const v=j=>{if(j.key==="Escape"&&t(),j.key==="Tab"&&p.current){const $=p.current.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');if($.length===0)return;const B=$[0],d=$[$.length-1];!j.shiftKey&&document.activeElement===d?(j.preventDefault(),B.focus()):j.shiftKey&&document.activeElement===B&&(j.preventDefault(),d.focus())}};return document.addEventListener("keydown",v),setTimeout(()=>{if(p.current){const j=p.current.querySelector('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');j?j.focus():p.current.focus()}},0),()=>document.removeEventListener("keydown",v)},[s,t]),!s)return null;let m,h="Dialog";return pe.Children.forEach(a,v=>{pe.isValidElement(v)&&(v.type==="h1"||v.type==="h2"||v.type==="h3")&&(v.props.id?m=v.props.id:v.props.children&&(m="modal-heading-auto",h=void 0))}),e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/40 ${i}`,onClick:t,style:{pointerEvents:"auto"},"aria-modal":"true",role:"dialog",...m?{"aria-labelledby":m}:{"aria-label":h},children:e.jsxs("div",{ref:p,className:`relative rounded-xl shadow-2xl border p-6 transition-all duration-300 ${x?"bg-gray-800 border-gray-700":"bg-white border-blue-200"} ${o}`,onClick:v=>v.stopPropagation(),tabIndex:-1,children:[m==="modal-heading-auto"?e.jsx("h2",{id:"modal-heading-auto",children:h}):null,a]})})},ye=pe.memo(It);class Dt extends r.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){console.error("❌ React Error Boundary caught an error:",t),console.error("Error info:",a),this.setState({error:t,errorInfo:a})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 p-4",children:e.jsx("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"😵"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"The application encountered an error and couldn't load properly."}),this.state.error&&e.jsxs("details",{className:"text-left bg-gray-50 dark:bg-gray-700 p-4 rounded mb-4",children:[e.jsx("summary",{className:"cursor-pointer font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Error Details"}),e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400 font-mono",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Error:"})," ",this.state.error.message]}),this.state.error.stack&&e.jsxs("div",{children:[e.jsx("strong",{children:"Stack:"}),e.jsx("pre",{className:"whitespace-pre-wrap text-xs mt-1",children:this.state.error.stack})]})]})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition-colors",children:"Reload Application"})]})})}):this.props.children}}window.appTsxLoaded=!0;console.log("🚀 App.tsx module started loading...");console.log("✅ React hooks imported successfully");let we=null,ue=null,G=null;const Ft=r.lazy(()=>Q(()=>import("./Home-BKUgmSkZ.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),$t=r.lazy(()=>Q(()=>import("./Favorites-BxZv8Rpt.js"),__vite__mapDeps([5,1,2,3,6,4]),import.meta.url)),Rt=r.lazy(()=>Q(()=>import("./Ongoing-DBkgtTBk.js"),__vite__mapDeps([7,1,2,3,6]),import.meta.url)),Ot=r.lazy(()=>Q(()=>import("./CollectionsSection-CZk0Mrrt.js"),__vite__mapDeps([8,1,2,3,6,4]),import.meta.url)),Ut=r.lazy(()=>Q(()=>import("./Weaknesses-P9APNICs.js"),__vite__mapDeps([9,1,2]),import.meta.url)),Mt=r.lazy(()=>Q(()=>import("./Settings-BuyjKNtP.js"),__vite__mapDeps([10,1,2]),import.meta.url));function Bt(){const{favorites:s,collections:t,ongoing:a,removeFavorite:o,addFavorite:i,addPathToCollection:p}=Ke(),[w,x]=r.useState(""),[m,h]=r.useState(""),[v,j]=r.useState(""),[$,B]=r.useState(""),[d,L]=r.useState(""),[C,k]=r.useState(""),[c,_]=r.useState("lookup"),[se,re]=r.useState(!1),[Ye,T]=r.useState(null),[z,ge]=r.useState("home"),[Se,Ge]=r.useState(3),[ae,Qe]=r.useState(""),[oe,Ce]=r.useState(20),[ke,Xe]=r.useState(!0),[Ne,R]=r.useState(null),[Ze,W]=r.useState(!1),[_e,H]=r.useState(null),[V,Pe]=r.useState(null),[et,Te]=r.useState(null),[tt,me]=r.useState(null),[st,he]=r.useState(""),[rt,ne]=r.useState(null),[le,fe]=r.useState(null),[Ae,ie]=r.useState(!1),[O,Le]=r.useState(null),[Ie,ce]=r.useState(!1),[De,de]=r.useState(null),[at,Fe]=r.useState([]),[ot,$e]=r.useState(null),[Re,Oe]=r.useState(!1);r.useEffect(()=>{(async()=>{try{console.log("🔄 Loading Tauri APIs from global object...");const u=window.__TAURI__;u?(console.log("✅ Tauri global object available"),ue=u.invoke,G=u.event.listen,we={sidecar:f=>({execute:async()=>u.shell?u.shell.sidecar(f).execute():{code:-1,stdout:"",stderr:"Shell plugin not available"}})},console.log("✅ Tauri APIs loaded from global object")):(console.warn("⚠️ Tauri global object not available"),ue=async()=>{throw new Error("Tauri invoke not available")},G=async()=>()=>{},we={sidecar:()=>({execute:async()=>({code:-1,stdout:"",stderr:"Tauri not available"})})}),Oe(!0),console.log("🎉 Tauri APIs ready")}catch(u){console.error("❌ Failed to load Tauri APIs:",u),Oe(!0)}})()},[]);function xe(n,u){fe({message:n,type:u}),setTimeout(()=>fe(null),2500)}r.useEffect(()=>{document.documentElement.classList.remove("dark")},[]),r.useEffect(()=>{if(!Re)return;(async()=>{try{console.log("Loading Pal list from Tauri command...");const u=await ue("get_pal_list");Fe(u),console.log(`✓ Received ${u.length} Pal names from Tauri command`)}catch(u){console.error("❌ Failed to load Pal list from Tauri command:",u),Fe([])}})()},[Re]),r.useEffect(()=>{const n=async()=>{R({current:0,max:0,label:"all"}),W(!0),H(null);try{await K("binaries/image-scraper","images"),await K("binaries/breeding-scraper","breeding data"),await K("binaries/fullcalc-scraper","full calc"),R(null),alert("All data updated successfully!")}catch(l){H("Failed to update all data: "+l)}W(!1)},u=async()=>{R({current:0,max:0,label:"images"}),W(!0),H(null);try{await K("binaries/image-scraper","images"),R(null),alert("Images updated successfully!")}catch(l){H("Failed to update images: "+l)}W(!1)},f=async()=>{R({current:0,max:0,label:"breeding data"}),W(!0),H(null);try{await K("binaries/breeding-scraper","breeding data"),R(null),alert("Breeding data updated successfully!")}catch(l){H("Failed to update breeding data: "+l)}W(!1)},N=async()=>{R({current:0,max:0,label:"full calc"}),W(!0),H(null);try{await K("binaries/fullcalc-scraper","full calc"),R(null),alert("Full calculator updated successfully!")}catch(l){H("Failed to update full calculator: "+l)}W(!1)},y=()=>{window.confirm("Are you sure you want to reset all favorites and ongoing progress? This cannot be undone.")&&(localStorage.removeItem("favorites"),localStorage.removeItem("ongoing"),window.dispatchEvent(new CustomEvent("favoritesUpdated")),alert("Local storage reset!"))};return window.addEventListener("updateAllData",n),window.addEventListener("updateImages",u),window.addEventListener("updateBreeding",f),window.addEventListener("updateFullCalc",N),window.addEventListener("resetLocalStorage",y),()=>{window.removeEventListener("updateAllData",n),window.removeEventListener("updateImages",u),window.removeEventListener("updateBreeding",f),window.removeEventListener("updateFullCalc",N),window.removeEventListener("resetLocalStorage",y)}},[]),r.useEffect(()=>{if(V){Te(V);const n=setTimeout(()=>Te(null),5e3);return()=>clearTimeout(n)}},[V]);async function K(n,u){return new Promise(async(f,N)=>{let y=0,l=0;R({current:y,max:l,label:u});const S=await G("sidecar-progress",b=>{const{script:I,current:D,max:U}=b.payload;I===n&&(y=D,l=U,R({current:y,max:l,label:u}),console.log(`📈 Progress update: ${y}/${l} for ${u}`))}),E=await G("sidecar-output",b=>{const{script:I,output:D}=b.payload;I===n&&console.log(`📊 [${n}] ${D}`)}),P=await G("sidecar-error",b=>{const{script:I,error:D}=b.payload;I===n&&console.error(`❌ [${n}] ${D}`)}),A=await G("sidecar-complete",b=>{const{script:I,success:D,exit_code:U}=b.payload;I===n&&(S(),E(),P(),A(),D?(console.log(`✅ Script ${n} completed successfully`),f()):(console.error(`❌ Script ${n} failed with exit code ${U}`),N(new Error(`Script failed with exit code ${U}`))))});try{await ue("run_sidecar_with_progress",{script:n,label:u})}catch(b){S(),E(),P(),A(),console.error(`💥 Error running script ${n}:`,b),N(b)}})}const Ue=async n=>{let u=c==="lookup"?w:v,f=c==="lookup"?m:$,N=c==="pathfind"?d:"",y=c==="childlookup"?C:"";if(c==="childlookup"&&!y){T({type:"child_lookup",result:"",error:"Please provide a target child"});return}if(c!=="childlookup"&&!u&&!f&&!N){T({type:"parent_lookup",result:"",error:"Please provide at least two parameters"});return}re(!0),T(null);try{if(c==="lookup"&&u&&f){const l=await We.findChild(u,f);T(l?{type:"parent_lookup",result:`${u} + ${f} = ${l}`,jsonData:{child:l,parent1:u,parent2:f}}:{type:"parent_lookup",result:"No breeding combination found",jsonData:{child:null,parent1:u,parent2:f}}),re(!1);return}else if(c==="childlookup"&&y){const l=await We.findParents(y);if(l.length>0){const S=l.map((E,P)=>({id:P,startParent:E.parent1,targetChild:y,steps:[{type:"start",pal:E.parent1,step_number:0},{type:"breed",parents:`${E.parent1} + ${E.parent2}`,result:y,step_number:1,is_final:!0}],totalSteps:1,totalBreedingSteps:1}));T({type:"child_lookup",result:`Found ${l.length} parent combination(s) for ${y}`,jsonData:{success:!0,start_parent:l[0]?.parent1||"",target_child:y,total_paths:S.length,min_steps:1,paths:S.map((E,P)=>({type:"single",path:{id:P,steps:E.steps,total_steps:1}}))}})}else T({type:"child_lookup",result:"No parent combinations found",jsonData:{success:!1,start_parent:"",target_child:y,total_paths:0,min_steps:0,paths:[],message:"No parent combinations found for this child"}});re(!1);return}if(c==="pathfind"){let l=Se;ae&&!isNaN(Number(ae))&&(l=Number(ae));let S;if(ke?typeof n=="number"?S=n:typeof oe=="number"?S=oe:S=20:S=1e6,isNaN(S)&&(S=20),u&&N){let E=[];E=["-p1",u,"-c",N,"--json","--max-paths",String(S)],l>0&&E.push("--max-seconds",String(l)),console.log(`🚀 Executing Python sidecar in ${c} mode`),console.log(`📝 Sidecar: binaries/breeding-path ${E.join(" ")}`),console.log("📋 Arguments:",E),console.log("🔍 DEBUGGING BINARY DISCOVERY:"),console.log("   Target binary: binaries/breeding-path (Tauri will auto-resolve to .exe on Windows)"),console.log(`   Platform: ${navigator.platform}`),console.log(`   User agent: ${navigator.userAgent}`),console.log("📁 Tauri sidecar will automatically resolve the binary name based on platform"),console.log("⚙️ Creating sidecar command...");const P=we.sidecar("binaries/breeding-path",E);console.log("✅ Command object created successfully"),console.log("🎯 Executing command...");const A=await P.execute();if(console.log("🎉 Sidecar executed successfully"),console.log("📋 Exit code:",A.code),console.log("📋 STDOUT:",A.stdout),console.log("📋 STDERR:",A.stderr),A.code===0)try{const b=JSON.parse(A.stdout);if(b.paths&&Array.isArray(b.paths)){const I=new Map,D=g=>{if(g.type==="single"&&g.path){const ee=g.path.steps.filter(F=>F.type==="breed").map(F=>F.parents).sort().join("|"),q=`${g.path.steps.find(F=>F.type==="start")?.pal||""}|${ee}`;I.has(q)||I.set(q,g)}},U=g=>{g.type==="single"?D(g):g.type==="group"&&g.children&&g.children.forEach(U)};b.paths.forEach(U);const J=Array.from(I.values());if(J.length>1){const g=new Map;J.forEach(M=>{const q=M.path.steps.filter(F=>F.type==="breed").map(F=>F.parents).sort().join("|");g.has(q)||g.set(q,[]),g.get(q).push(M)});const ee=[];g.forEach(M=>{if(M.length===1)ee.push(M[0]);else{const q=M[0].path.steps.filter(F=>F.type==="breed");ee.push({type:"group",common_steps:q,children:M,count:M.length})}}),b.paths=ee,b.total_paths=J.length}else J.length===1?(b.paths=J,b.total_paths=1):(b.paths=[],b.total_paths=0)}T({type:"path_finding",result:A.stdout,jsonData:b})}catch{T({type:"path_finding",result:A.stdout})}else T({type:"path_finding",result:"",error:`Sidecar failed with exit code ${A.code}: ${A.stderr||"No error message"}`})}else throw new Error("For pathfinding, provide a parent and a target child")}else throw new Error("Invalid parameter combination")}catch(l){console.error("💥 Exception during sidecar execution:",l),console.error("💥 Error type:",typeof l),console.error("💥 Error constructor:",l?.constructor?.name),l instanceof Error&&(console.error("💥 Error message:",l.message),console.error("💥 Error stack:",l.stack)),console.error("🔬 DETAILED ERROR ANALYSIS:"),console.error("   Error string representation:",String(l)),console.error("   Error JSON:",JSON.stringify(l,null,2)),String(l).includes("not found")&&(console.error("🎯 BINARY NOT FOUND ERROR DETECTED"),console.error("   This suggests Tauri cannot locate the sidecar binary"),console.error("   Check the following:"),console.error("   1. Binary exists in src-tauri/binaries/"),console.error("   2. tauri.conf.json externalBin configuration"),console.error("   3. capabilities/default.json permissions"),console.error("   4. Binary naming convention matches platform")),T({type:c==="lookup"?"parent_lookup":c==="childlookup"?"child_lookup":"path_finding",result:"",error:`Sidecar execution failed: ${l instanceof Error?l.message:"Unknown error occurred"}`})}finally{re(!1),console.log("🏁 Sidecar execution finished, loading state cleared")}},nt=()=>{x(""),h(""),j(""),B(""),L(""),k(""),T(null)},lt=n=>{_(n),T(null)},Me=n=>{j(n.startParent),L(n.targetChild),_("pathfind"),ge("home"),T(null)},Be=n=>{ge("favorites"),Pe(null),setTimeout(()=>Pe(n.favorite.id),0),$e(n.favorite.id),setTimeout(()=>$e(null),2e3)},it=n=>{},ct=()=>{const n=oe+20;Ce(n),Ue(n)},be=pe.useRef({});r.useEffect(()=>{V&&be.current[V]&&be.current[V]?.scrollIntoView({behavior:"smooth",block:"center"})},[V]);function dt(n,u){const f=s.find(g=>g.id===u);if(!f)return;let N=[],y="",l="";if(n.targetChild===f.startParent)N=[...n.steps,...f.steps.filter(g=>g.type!=="start")],y=n.startParent,l=f.targetChild;else if(f.targetChild===n.startParent)N=[...f.steps,...n.steps.filter(g=>g.type!=="start")],y=f.startParent,l=n.targetChild;else{xe("Paths do not connect!","error"),ne(null);return}let S=1;const E=N.map(g=>g.type==="breed"?{...g,step_number:S++,is_final:!1}:{...g});for(let g=E.length-1;g>=0;--g)if(E[g].type==="breed"){E[g].is_final=!0;break}const P=E.filter(g=>g.type==="breed");let A=P[0]?.parents?.split(" + ")[0]||"",b=P[0]?.parents?.split(" + ")[1]||"";!b&&P[1]&&(b=P[1]?.parents?.split(" + ")[0]||"");const I=P[P.length-1]?.result||l,D=`${A}${b?" + "+b:""} → ${I}`,U=f.customName?.trim()?f.customName:D,J=f.customName?.trim()?f.customName:void 0;i({name:U,startParent:y,targetChild:l,steps:E,customName:J}),o(n.id),o(f.id),ne(null),xe("Paths combined!","success")}const ve=n=>{Le(n),ie(!0)},ut=()=>{if(!O||!De)return;let n=wt(O.startParent,O.targetChild,O.steps);if(!n){const u=O.steps.find(S=>S.type==="start"),f=O.steps.find(S=>S.is_final),N=O.startParent||u?.pal||"Unknown Parent",y=O.targetChild||f?.result||"Unknown Child",l={name:`${N} → ${y}`,startParent:N,targetChild:y,steps:O.steps};n=i(l)}p(De,n),ie(!1),ce(!1),Le(null),de(null),xe("Path added to collection!","success")};function pt(n){me(n.id),he(n.customName??"")}function gt(){me(null),he("")}function mt(){me(null),he("")}function ht(n){ne(n.id)}function ft(){ne(null)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 -z-10 w-screen h-screen bg-repeat-y bg-gradient-repeat",style:{pointerEvents:"none"}}),e.jsxs("div",{className:"min-h-screen transition-colors duration-300",children:[e.jsx(Lt,{currentSection:z,onSectionChange:ge,onFavoriteSelect:Me,onOngoingSelect:Be}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8 relative",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 gradient-header-text",children:"Palworld Breeding Calculator"}),e.jsx("p",{className:`text-lg ${document.documentElement.classList.contains("dark")?"text-white/80":"text-gray-600"}`,children:"Find breeding combinations and shortest paths to your desired Pals"})]}),z==="settings"&&e.jsx(r.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(Mt,{isRunning:Ze,progress:Ne,progressError:_e,onUpdateAllData:()=>window.dispatchEvent(new CustomEvent("updateAllData")),onUpdateImages:()=>window.dispatchEvent(new CustomEvent("updateImages")),onUpdateBreeding:()=>window.dispatchEvent(new CustomEvent("updateBreeding")),onResetLocalStorage:()=>window.dispatchEvent(new CustomEvent("resetLocalStorage"))})}),z==="home"&&e.jsx(r.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(Ft,{mode:c,setMode:lt,lookupParent1:w,setLookupParent1:x,lookupParent2:m,setLookupParent2:h,pathfindParent1:v,setPathfindParent1:j,pathfindTargetChild:d,setPathfindTargetChild:L,childLookupTarget:C,setChildLookupTarget:k,computationTime:Se,setComputationTime:Ge,customTime:ae,setCustomTime:Qe,isLoading:se,result:Ye,maxPaths:oe,setMaxPaths:Ce,maxPathsEnabled:ke,setMaxPathsEnabled:Xe,onRun:Ue,onClear:nt,onLoadMore:ct,onAddToCollection:ve,progress:Ne,progressError:_e,palList:at})}),z==="favorites"&&e.jsx(r.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx($t,{favorites:s,selectedFavoriteId:V,highlightedFavoriteId:et,editingFavoriteId:tt,editingName:st,combiningFavoriteId:rt,handleEditFavoriteName:pt,handleSaveFavoriteName:gt,handleCancelEditFavoriteName:mt,handleCombineWithFavorite:dt,handleStartCombining:ht,handleCancelCombining:ft,handleFavoriteSelect:Me,onAddToCollection:ve,favoriteRefs:be,onRemoveFavorite:it})}),z==="ongoing"&&e.jsx(r.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(Rt,{ongoing:a,handleOngoingSelect:Be,onAddToCollection:ve,pulseItemId:ot})}),z==="collections"&&e.jsx(r.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(Ot,{})}),z==="weaknesses"&&e.jsx(r.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(Ut,{})}),z==="home"&&e.jsx(e.Fragment,{})]})})]}),le&&e.jsx(ye,{open:!!le,onClose:()=>fe(null),className:`top-8 left-1/2 -translate-x-1/2 px-6 py-3 rounded-xl-std shadow-xl-std font-semibold text-center transition-all ${le.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,overlayClassName:"bg-transparent flex items-start justify-center z-50",children:le.message}),Ae&&e.jsxs(ye,{open:Ae,onClose:()=>ie(!1),className:"w-full max-w-sm border-blue-200 rounded-xl-std shadow-xl-std bg-white dark:bg-gray-800 flex flex-col",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 text-blue-700 dark:text-blue-200",children:"Add Path to Collection"}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-4",children:t.length===0?e.jsx("div",{className:"text-gray-400 text-sm text-center",children:"No collections available. Create one first."}):e.jsx("ul",{className:"space-y-2",children:t.map(n=>e.jsx("li",{children:e.jsx("button",{className:`w-full text-left px-4 py-2 rounded transition font-medium border border-gray-300 dark:border-gray-700 group bg-gray-50 dark:bg-gray-800\r
                        hover:bg-gradient-to-r hover:from-blue-100 hover:to-purple-100 dark:hover:from-blue-900 dark:hover:to-purple-900\r
                        hover:shadow-lg hover:border-blue-400 dark:hover:border-purple-500`,onClick:()=>{de(n.id),ce(!0)},children:e.jsx("span",{className:"text-base font-semibold text-blue-900 dark:text-blue-100 group-hover:text-blue-700 dark:group-hover:text-purple-300 transition-colors duration-200",children:n.name})})},n.id))})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>ie(!1),children:"Cancel"})}),Ie&&e.jsxs(ye,{open:Ie,onClose:()=>{ce(!1),de(null)},className:"w-full max-w-sm border-blue-200 rounded-xl-std shadow-xl-std bg-white dark:bg-gray-800",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 text-blue-700 dark:text-blue-200",children:"Confirm Add"}),e.jsx("div",{className:"mb-4 text-gray-700 dark:text-gray-200",children:"Are you sure you want to add this path to the selected collection?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600",onClick:()=>{ce(!1),de(null)},children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 transition",onClick:ut,children:"Confirm"})]})]})]})]})}function zt(){return r.useEffect(()=>{console.log("🚀 App starting..."),console.log("Environment:","production"),console.log("Base URL:","./"),console.log("User Agent:",navigator.userAgent);const s=document.getElementById("debug-status");s&&(s.innerHTML+="<br>🚀 React App starting...",s.innerHTML+="<br>Environment: production",s.innerHTML+="<br>Base URL: ./"),window.__TAURI__?(console.log("✅ Tauri environment detected"),s&&(s.innerHTML+="<br>✅ Tauri environment detected")):(console.log("⚠️  Not in Tauri environment"),s&&(s.innerHTML+="<br>⚠️  Not in Tauri environment")),window.addEventListener("error",t=>{console.error("❌ Global error:",t.error),s&&(s.innerHTML+="<br>❌ Global error: "+(t.error?.message||"Unknown error"))}),window.addEventListener("unhandledrejection",t=>{console.error("❌ Unhandled promise rejection:",t.reason),s&&(s.innerHTML+="<br>❌ Unhandled promise rejection: "+t.reason)})},[]),e.jsx(Dt,{children:e.jsx(At,{children:e.jsx(_t,{children:e.jsx(Bt,{})})})})}const Jt=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"}));export{Jt as A,ze as B,Y as L,ye as M,je as T,xt as a,Ht as b,qt as g,wt as i,Vt as t,Ke as u};
