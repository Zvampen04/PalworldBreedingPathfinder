import{r as x,j as e}from"./index-C44N1bVH.js";import{E as _}from"./ExpandablePaths-RjC-xIgd.js";import{I}from"./Input-VEm_snOz.js";import{T as F,g as B,B as N,L as A}from"./App-CjdM32UX.js";const z=({className:a="",theme:l,...f})=>{const b=x.useContext(F),y=(l||b?.mode||"light")==="dark"?"accent-blue-400 focus:ring-blue-400/50":"accent-blue-600 focus:ring-blue-500/50";return e.jsx("input",{type:"radio",className:`${y} focus:ring-2 ${a}`,...f})},D=({label:a,value:l,onChange:f,palList:b,required:$=!1,disabled:y=!1})=>{const o=x.useContext(F)?.mode==="dark",[n,m]=x.useState(!1),[g,j]=x.useState(""),v=x.useRef(null),k=x.useRef(null),[u,h]=x.useState(-1),r=x.useMemo(()=>g?b.filter(t=>t.toLowerCase().includes(g.toLowerCase())):b,[g,b]);x.useEffect(()=>{n&&k.current&&k.current.focus()},[n]),x.useEffect(()=>{const t=d=>{v.current&&!v.current.contains(d.target)&&(m(!1),j(""))};if(n)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[n]),x.useEffect(()=>{h(n?r.findIndex(t=>t===l):-1)},[n,r,l]);const c=t=>{f(t),m(!1),j("")},E=()=>{y||m(!n)},S=t=>{t.key==="Escape"?(m(!1),j("")):t.key==="Enter"?n&&u>=0&&u<r.length?c(r[u]):!n&&r.length>0&&!l&&m(!0):t.key==="ArrowDown"?(t.preventDefault(),n?h(d=>d<r.length-1?d+1:0):(m(!0),h(0))):t.key==="ArrowUp"&&(t.preventDefault(),n?h(d=>d>0?d-1:r.length-1):(m(!0),h(r.length-1)))};return e.jsxs("div",{className:"relative",ref:v,children:[e.jsxs("label",{id:`palselector-label-${a.replace(/\s+/g,"-")}`,className:`block text-sm font-medium mb-2 ${o?"text-white":"text-gray-800"}`,children:[a,$&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("div",{role:"combobox","aria-haspopup":"listbox","aria-expanded":n,"aria-controls":`palselector-listbox-${a.replace(/\s+/g,"-")}`,"aria-labelledby":`palselector-label-${a.replace(/\s+/g,"-")}`,"aria-activedescendant":n&&u>=0?`palselector-option-${a.replace(/\s+/g,"-")}-${r[u]}`:void 0,tabIndex:0,className:`relative rounded-lg px-3 py-2 cursor-pointer transition-all duration-200 hover:border-blue-500 ${o?"bg-gray-800/80 border border-gray-600 text-white":"bg-white/80 border border-gray-300 text-gray-800"} ${y?"opacity-50 cursor-not-allowed":""} ${n?"border-blue-500 ring-2 ring-blue-500/50":""}`,onClick:E,onKeyDown:S,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[l&&e.jsx("img",{src:B(l),alt:l,className:"w-6 h-6 rounded-full object-cover",onError:t=>{t.target.style.display="none"}}),e.jsx("span",{className:l?o?"text-white":"text-gray-800":o?"text-gray-400":"text-gray-500",children:l||`Select ${a}`})]}),e.jsx("div",{className:`transform transition-transform duration-200 ${n?"rotate-180":""}`,children:"â–¼"})]})}),n&&e.jsxs("div",{id:`palselector-listbox-${a.replace(/\s+/g,"-")}`,role:"listbox","aria-labelledby":`palselector-label-${a.replace(/\s+/g,"-")}`,className:`absolute top-full left-0 right-0 mt-1 rounded-lg shadow-xl backdrop-blur-sm max-h-80 overflow-hidden z-[100] ${o?"bg-gray-800/95 border border-gray-600":"bg-white/95 border border-gray-300"}`,children:[e.jsx("div",{className:`p-2 ${o?"border-b border-gray-600":"border-b border-gray-300"}`,children:e.jsx("input",{ref:k,type:"text","aria-label":`Search ${a}`,placeholder:`Search ${a.toLowerCase()}...`,value:g,onChange:t=>j(t.target.value),onKeyDown:S,className:`w-full border rounded px-3 py-2 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 ${o?"bg-gray-700/80 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-800 placeholder-gray-500"}`,autoComplete:"off"})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:r.length>0?r.map((t,d)=>e.jsxs("div",{id:`palselector-option-${a.replace(/\s+/g,"-")}-${t}`,role:"option","aria-selected":t===l,className:`flex items-center space-x-3 px-3 py-2 cursor-pointer transition-colors ${o?"hover:bg-gray-700/50 text-white":"hover:bg-gray-100 text-gray-800"} ${u===d?o?"bg-blue-700/60":"bg-blue-100":""}`,onClick:()=>c(t),onMouseEnter:()=>h(d),children:[e.jsx("img",{src:B(t),alt:t,className:"w-6 h-6 rounded-full object-cover",onError:w=>{w.target.style.display="none"}}),e.jsx("span",{children:t})]},t)):e.jsxs("div",{className:`px-3 py-4 text-center ${o?"text-gray-400":"text-gray-500"}`,children:['No Pals found matching "',g,'"']})}),l&&e.jsx("div",{className:`p-2 ${o?"border-t border-gray-600":"border-t border-gray-300"}`,children:e.jsx("button",{onClick:()=>c(""),"aria-label":"Clear selection",className:`w-full text-left px-3 py-2 text-red-400 rounded transition-colors ${o?"hover:bg-gray-700/50":"hover:bg-gray-100"}`,children:"Clear Selection"})})]})]})},Q=({mode:a,setMode:l,lookupParent1:f,setLookupParent1:b,lookupParent2:$,setLookupParent2:y,pathfindParent1:P,setPathfindParent1:o,pathfindTargetChild:n,setPathfindTargetChild:m,childLookupTarget:g,setChildLookupTarget:j,computationTime:v,setComputationTime:k,customTime:u,setCustomTime:h,isLoading:r,result:c,maxPaths:E,setMaxPaths:S,maxPathsEnabled:t,setMaxPathsEnabled:d,onRun:w,onClear:K,onLoadMore:O,onAddToCollection:R,progress:p,progressError:q,palList:C})=>{const s=x.useContext(F)?.mode==="dark";return e.jsxs("div",{id:"main-content",className:`p-6 md:p-8 mb-6 rounded-xl-std shadow-xl-std transition-all duration-300 ${s?"bg-white/10 backdrop-blur-md border border-white/20":"bg-white/80 backdrop-blur-md border border-gray-200"}`,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:`block font-semibold mb-3 ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Mode:"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx(z,{type:"radio",name:"mode",value:"lookup",checked:a==="lookup",onChange:i=>l(i.target.value),className:"sr-only",theme:s?"dark":"light"}),e.jsx(N,{type:"button",variant:a==="lookup"?"primary":"secondary",size:"lg",dark:s,className:"px-6 py-3 rounded-lg font-semibold transition-all",onClick:()=>l("lookup"),"aria-pressed":a==="lookup",children:"ðŸ” Parent Lookup"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx(z,{type:"radio",name:"mode",value:"pathfind",checked:a==="pathfind",onChange:i=>l(i.target.value),className:"sr-only",theme:s?"dark":"light"}),e.jsx(N,{type:"button",variant:a==="pathfind"?"primary":"secondary",size:"lg",dark:s,className:"px-6 py-3 rounded-lg font-semibold transition-all",onClick:()=>l("pathfind"),"aria-pressed":a==="pathfind",children:"ðŸŽ¯ Path Finding"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx(z,{type:"radio",name:"mode",value:"childlookup",checked:a==="childlookup",onChange:i=>l(i.target.value),className:"sr-only",theme:s?"dark":"light"}),e.jsx(N,{type:"button",variant:a==="childlookup"?"primary":"secondary",size:"lg",dark:s,className:"px-6 py-3 rounded-lg font-semibold transition-all",onClick:()=>l("childlookup"),"aria-pressed":a==="childlookup",children:"ðŸ” Child Lookup"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:[a==="lookup"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(D,{label:"Parent 1",value:f,onChange:b,palList:C,required:!0,disabled:r})}),e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(D,{label:"Parent 2",value:$,onChange:y,palList:C,required:!0,disabled:r})})]}),a==="pathfind"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(D,{label:"Parent 1",value:P,onChange:o,palList:C,required:!0,disabled:r})}),e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(D,{label:"Target Child",value:n,onChange:m,palList:C,required:!0,disabled:r})})]}),a==="childlookup"&&e.jsx("div",{className:"col-span-1 mb-4",children:e.jsx(D,{label:"Target Child",value:g,onChange:j,palList:C,required:!0,disabled:r})})]}),a==="pathfind"&&e.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Computation Time:"}),[1,3,5,10].map(i=>e.jsxs(N,{onClick:()=>{k(i),h("")},variant:v===i&&!u?"primary":"secondary",size:"sm",dark:s,children:[i,"s"]},i)),e.jsx(I,{type:"number",min:1,max:60,placeholder:"Custom",value:u,onChange:i=>{h(i.target.value),k(Number(i.target.value)||v)},className:"w-20 ml-2",theme:s?"dark":"light"}),e.jsx("span",{className:`text-xs ml-2 ${s?"text-gray-400":"text-gray-500"}`,children:"seconds"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{type:"checkbox",checked:t,onChange:i=>d(i.target.checked),className:"mr-2",theme:s?"dark":"light"}),e.jsx("span",{className:`font-medium ${s?"text-accessible-dark":"text-accessible-light"}`,children:"Limit Max Paths"}),e.jsx(I,{type:"number",min:1,max:1e3,value:E,onChange:i=>S(Number(i.target.value)||20),className:"w-20 ml-2",theme:s?"dark":"light",disabled:!t}),e.jsx("span",{className:`text-xs ml-2 ${s?"text-gray-400":"text-gray-500"}`,children:"paths"})]})]}),p&&e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:`text-lg font-semibold mb-2 ${s?"text-accessible-dark":"text-accessible-light"}`,children:`Updating ${p.label}...`}),p.max>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-2 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:`${p.current/p.max*100}%`}})}),e.jsxs("div",{className:`text-sm ${s?"text-gray-200":"text-gray-700"}`,children:[p.current," / ",p.max]})]}):e.jsx("div",{className:`text-sm ${s?"text-gray-200":"text-gray-700"}`,children:"Starting..."})]}),q&&e.jsx("div",{className:"mt-4 text-red-500 font-semibold",children:q}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center mb-8",children:[e.jsx(N,{onClick:w,disabled:a==="lookup"?!f||!$:a==="childlookup"?!g:r||!P||!n,variant:"primary",size:"lg",loading:r,dark:s,children:r?"Calculating...":`${a==="lookup"?"Find Child":a==="childlookup"?"Find Parents":"Find Paths"}`}),e.jsx(N,{onClick:K,variant:"secondary",size:"lg",dark:s,children:"Clear All"})]}),a==="lookup"&&c&&!r&&e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${s?"text-green-200":"text-green-800"}`,children:"Breeding Result"}),e.jsx("div",{className:`mt-4 text-lg ${s?"text-white":"text-gray-800"}`,children:c.result})]}),a==="childlookup"&&c&&!r&&c.type==="child_lookup"&&c.jsonData&&e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:`text-2xl font-bold text-center mb-6 ${s?"text-green-200":"text-green-800"}`,children:["Parent Combinations for ",c.jsonData.target_child]}),e.jsx(_,{data:c.jsonData,maxPaths:c.jsonData.total_paths,onLoadMore:()=>{},onAddToCollection:R})]}),a==="pathfind"&&c&&!r&&c.type==="path_finding"&&c.jsonData&&e.jsx(_,{data:c.jsonData,maxPaths:E,onLoadMore:O,onAddToCollection:R}),r&&e.jsx(A,{})]})};export{Q as default};
